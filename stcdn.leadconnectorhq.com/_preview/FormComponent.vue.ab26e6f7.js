var Oa=Object.defineProperty;var Ra=(s,n,f)=>n in s?Oa(s,n,{enumerable:!0,configurable:!0,writable:!0,value:f}):s[n]=f;var Kt=(s,n,f)=>(Ra(s,typeof n!="symbol"?n+"":n,f),f);import{M as Oo,I as Or,r as y,E as Rr,P as zr,B as Ne,d as za,J as Yt,G as Na,c as Ee,u as Ua,o as xa,x as io,ac as Ba,g as Ma,a as w,b as Lt,l as so,f as r,e as Ot,m as Rt,i as We,n as Qt,F as qa,k as $a,h as A,T as Wa,q as M,j as Ha,s as q}from"./entry.0e8f1b40.js";import{S as ja}from"./components.e5153daf.js";import{_ as Ga}from"./TextElement.vue.7259e379.js";import{_ as Ja}from"./TextBoxListElement.vue.9d0af45a.js";import{_ as Ka}from"./TextAreaElement.vue.908bb552.js";import{_ as Ya}from"./HtmlInput.vue.eac6733b.js";import{_ as Qa}from"./OptionElement.vue.f8cc3486.js";/* empty css                            */import{u as Za,_ as Xa}from"./authorizeNet.c6c52083.js";import{u as en,f as Zt,q as Fr,e as Po,r as tn,h as on,j as rn,k as an}from"./index.35670e06.js";/* empty css            */import{j as fe,k as nn,U as Ro,W as co,V as zo,w as zt,N as Nr,G as uo,a8 as mo,ak as sn,ap as ln,u as dn,E as ko,ai as Do,$ as un,H as wr,Y as To,as as cn,O as mn,P as fn,Q as Er,R as pn,S as yn,z as lo,X as Pr,I as H,at as _t,J as kr,au as hn,L as vn,M as Vo,av as Ao,T as _n}from"./constants.c1fa6fa6.js";import{i as gn,f as Dr}from"./funnel_event_helper.495be8ad.js";import{L as Ur,l as xr,C as Pe}from"./localeData.865a95fc.js";import{c as bn,d as Sn}from"./utils.06d161ac.js";import{P as In,C as Tr,x as Cn,h as Fn,A as Vr,B as wn,e as Ar,D as En}from"./calendar_helper.002810c5.js";import{a as Br}from"./advancedFormat.b0e12780.js";import{u as Pn,t as kn}from"./utc.fdc7e349.js";import{a as Dn}from"./currency_helper.ed08bd45.js";import{_ as Tn}from"./MoonLoader.vue.bd0211ae.js";import{c as Lr}from"./cloneDeep.62c1ed29.js";fe.extend(Br);fe.extend(Ur);fe.extend(xr);fe.extend(Pn);fe.extend(kn);const Lo=fe.tz.guess(),Vn=["payment_intent","payment_intent_client_secret","redirect_status","sourceId","transactionId","altId","altType","setup_intent","setup_intent_client_secret"],Li=s=>["payment_intent","payment_intent_client_secret","redirect_status","setup_intent","setup_intent_client_secret"].some(n=>s[n]);class Oi{constructor(){Kt(this,"state",Oo({}));Kt(this,"newBaseUrl","");Kt(this,"t",Or().t);Kt(this,"newCardPaymentElementRef",y());const n=zr();this.newBaseUrl=n.public.newBaseURL,this.newCardPaymentElementRef=y(),this.state=Oo({prev:!1,isInitialFetch:!0,timezone:Lo,calendarStartingDate:fe().tz(Lo).format("YYYY-M-D"),appointmentDate:void 0,calendarRange:{from:fe().tz(Lo).format("YYYY-M-D"),to:""},availableTimezones:[],selectedTimezone:void 0,selectedStaffMember:void 0,filterTimezone:"",formData:void 0,appointmentId:void 0,recurrenceId:void 0,appointmentIds:[],seqCall:0,isComponentLoading:!0,isLoading:!1,isFetchingSlots:!1,isBackButtonDisabled:!1,isNextMonthDisabled:!1,submissionError:"",paymentProcessingError:"",daySlots:{},availableTimes:[],showNoDates:!1,selectedSlot:null,showRecurringSlots:!1,recurringSlots:[],loadingRecurringSlots:!1,isRecurringSlotLoaded:!1,currentCalendarStep:0,isFormFirst:!1,cancellationNote:"",isCancelled:!1,showFullDescription:!1,locationAddress:void 0,formThankyouMessage:void 0,guests:[],guestCountDetail:[],guestCount:void 0,terms_and_conditions:null,widgetConfiguration:void 0,calendar:{},showCalendarDetails:!0,showAllBookingDetails:!1,isRescheduling:!1,showFullThankYouMessage:!1,isForReschedule:!1,isMobileVersion:!1,isTabletVersion:!1,isForSpecificService:!1,calendarProvider:{},calenderTimezone:"",use24hFormat:!1,contact:void 0,contact_id:void 0,isRecurring:!1,showLoadingScreen:!1,isPaymentProcessing:!1,paymentRes:void 0,isPaymentEnabled:!1,stepInfo:{},formSubmissionData:{},fetchFreeSlots:!0,showDatePicker:!0,isPaymentWindowExpire:!1,uniqueId:nn(),autoNavigate:!1,shouldPayUsingPaymentElement:!0,paymentStatus:In.PENDING,setAutomatically:!1,meetingLocationId:void 0,bookerMeetingLocation:void 0,isSameContact:void 0,paymentSessionTimeoutSeconds:600,formattedAppointmentDate:void 0,isCustomPaymentProvider:!1,bookedSlot:void 0,isCustomPaymentProviderLoaded:!1,startSessionExpireTimer:!1,traceId:"",paymentSessionId:void 0,urlParams:{},pageUrl:""})}setCustomState(n){["prev","isInitialFetch","timezone","calendarStartingDate","appointmentDate","calendarRange","availableTimezones","selectedTimezone","selectedStaffMember","filterTimezone","formData","appointmentId","recurrenceId","appointmentIds","seqCall","isComponentLoading","isLoading","isFetchingSlots","isBackButtonDisabled","isNextMonthDisabled","submissionError","paymentProcessingError","daySlots","availableTimes","showNoDates","selectedSlot","showRecurringSlots","recurringSlots","loadingRecurringSlots","currentCalendarStep","isFormFirst","cancellationNote","isCancelled","showFullDescription","locationAddress","guests","guestCountDetail","terms_and_conditions","widgetConfiguration","calendar","showCalendarDetails","showAllBookingDetails","isRescheduling","showFullThankYouMessage","isForReschedule","isMobileVersion","isTabletVersion","isForSpecificService","calendarProvider","calenderTimezone","use24hFormat","contact","contact_id","isRecurring","showLoadingScreen","isPaymentProcessing","isPaymentEnabled","stepInfo","formSubmissionData","fetchFreeSlots","showDatePicker","isPaymentWindowExpire","uniqueId","autoNavigate","shouldPayUsingPaymentElement","paymentStatus","setAutomatically","paymentSessionTimeoutSeconds","formattedAppointmentDate","isCustomPaymentProvider","bookedSlot","isCustomPaymentProviderLoaded","startSessionExpireTimer","traceId","paymentSessionId","isRecurringSlotLoaded"].forEach(c=>{n[c]!==void 0&&(this.state[c]=n[c])})}resetSelectedSlot(){this.state.paymentSessionId||(this.state.selectedSlot=void 0)}setCalendarBookingState(n){var I,C,V,N,ae,Ie,Ce,pe,Ue,S;this.state.calendar=n.calendarService,this.state.isForReschedule=n.isForReschedule,this.state.isMobileVersion=n.isMobileVersion,this.state.isTabletVersion=n.isTabletVersion,this.state.use24hFormat=n.use24hFormat,this.state.isForSpecificService=n.isForSpecificService,this.state.calendarProvider=n.calendarProvider,this.state.calenderTimezone=n.calenderTimezone,this.state.isRecurring=!!((I=n==null?void 0:n.calendarService)!=null&&I.recurringRule);const f=(C=n.calendarService)==null?void 0:C.widget_config;f&&(this.state.widgetConfiguration={...f==null?void 0:f.primarySettings,default:(f==null?void 0:f.default)??!0});const c=(V=f==null?void 0:f.pageOrder)==null?void 0:V.find(je=>je.kind==="form");!n.isForReschedule&&(n.queryParams.isFormFirst==="true"||(c==null?void 0:c.position)===0)?(this.state.isFormFirst=!0,this.setCurrentStep(Tr.FORM)):this.setCurrentStep(Tr.CALENDAR),(N=n.queryParams)!=null&&N.shouldPayUsingPaymentElement&&(this.state.shouldPayUsingPaymentElement=((ae=n.queryParams)==null?void 0:ae.shouldPayUsingPaymentElement)==="true"),(Ie=n.queryParams)!=null&&Ie.paymentSessionTimeoutSeconds&&(this.state.paymentSessionTimeoutSeconds=Number((Ce=n.queryParams)==null?void 0:Ce.paymentSessionTimeoutSeconds));const o=Cn(n.queryParams);this.state.isPaymentEnabled=((pe=this.state.calendar)==null?void 0:pe.stripe)&&Object(this.state.calendar.stripe).hasOwnProperty("amount"),this.state.isCustomPaymentProvider=((S=(Ue=this.state.calendar)==null?void 0:Ue.stripe)==null?void 0:S.paymentProvider)==="custom-provider",o&&(n.widgetConfiguration=o),this.state.urlParams=n.urlParams,this.state.pageUrl=n.pageUrl}setFormSubmissionData(n){var f,c,o,I,C;((f=this.state.contact)==null?void 0:f.id)===n.contact.id&&(this.state.isSameContact=!0),this.state.contact=n.contact,this.state.contact_id=(c=n==null?void 0:n.contact)==null?void 0:c.id,this.state.guests=((o=n==null?void 0:n.formData)==null?void 0:o.guests)||[],this.state.guestCount=(I=n==null?void 0:n.formData)==null?void 0:I.guestCount,this.state.terms_and_conditions=(C=n==null?void 0:n.formData)==null?void 0:C.terms_and_conditions,this.state.formSubmissionData={...n}}setCalendarBookingStateForConfirmationPage(n){var f;this.state.isRecurring?(this.state.recurrenceId=n.appointment.recurrenceId,this.state.appointmentIds=n.ids):this.state.appointmentId=n.appointment.id,this.state.locationAddress=n.event_address,this.state.bookedSlot=(f=this.state.selectedSlot)==null?void 0:f.format(),this.state.traceId=n==null?void 0:n.traceId,this.state.isPaymentEnabled&&Pe.appointmentBookingLogs(this.state.traceId,{eventId:this.state.appointmentId,message:"appointment_booked"})}setCurrentStep(n){this.state.currentCalendarStep=n}resetCalendarState(){this.state.showLoadingScreen=!1,this.state.isBackButtonDisabled=!1,this.state.appointmentId=void 0,this.state.recurrenceId=void 0,this.state.appointmentIds=[],this.state.locationAddress=void 0,this.state.formSubmissionData={},this.state.stepInfo={},this.state.contact=void 0,this.state.contact_id=void 0,this.state.guests=[],this.state.guestCount=void 0,this.state.terms_and_conditions=null,this.state.isPaymentWindowExpire=!1,this.state.selectedStaffMember=void 0,this.state.selectedSlot=void 0,this.state.isPaymentProcessing=!1}async cancelCurrentAppointment(){try{await Pe.cancelAppointment(this.state.appointmentId,this.state.cancellationNote||"Payment is failed")}catch(n){console.error("error on cancel appointment",n)}}setMeetingLocationId(n){this.state.meetingLocationId=n}setBookerMeetingLocation(n){this.state.bookerMeetingLocation=n}setStepInfo(n){this.state.stepInfo={...this.state.stepInfo,event_address:(n==null?void 0:n.address)||(n==null?void 0:n.eventAddress)}}async handleSubmit(n){var N,ae,Ie,Ce,pe,Ue,S,je,Z,gt,ut,Ke,$,bt,ct,mt,ft,ye,z,ie,St,pt,Ge,yt,Xt,Je,Nt,It,he,Ct,ke,De,ve,ht,Ft,wt,x;const f=!!((ae=(N=this.state)==null?void 0:N.calendar)!=null&&ae.recurringRule),c=((Ie=this.state.formSubmissionData)==null?void 0:Ie.formData)||{};if(this.state.calendar&&(c.location_id=this.state.calendar.location_id,c.calendar_id=this.state.calendar.id,c.selected_slot=(Ce=this.state.selectedSlot)==null?void 0:Ce.format(),c.selected_timezone=(pe=this.state.selectedTimezone)==null?void 0:pe.value),c.form_submission_id=(Ue=this.state.formSubmissionData)==null?void 0:Ue.submissionId,this.state.guests.length?c.guests=this.state.guests:this.state.guestCountDetail&&(c.guestCount=this.state.guestCount),this.state.contact&&(c.contact={id:(S=this.state.contact)==null?void 0:S.id},((je=this.state.contact)==null?void 0:je.timezone)!==c.selected_timezone&&(c.contact.timezone=c.selected_timezone),c.contact_id=(Z=this.state.contact)==null?void 0:Z.id,c.terms_and_conditions=(gt=this.state)==null?void 0:gt.terms_and_conditions,c.guests=(ut=this.state)==null?void 0:ut.guests,c.guestCount=this.state.guestCount,c.form_submission_id=(Ke=this.state.formSubmissionData)==null?void 0:Ke.submissionId,(($=this.state.contact)!=null&&$.isNew||this.state.isSameContact)&&(c.is_new_contact=!0),c.skip_form_submit=!0),(bt=this.state.calendar)!=null&&bt.enable_same_user_assignment&&((ct=this.state.contact)!=null&&ct.assigned_to)&&!((mt=this.state.calendar)!=null&&mt.enable_staff_selection)){const u=(ft=this.state.contact)==null?void 0:ft.assigned_to,Q=(ye=this.state.calendar)==null?void 0:ye.team_members.findIndex(Ut=>Ut.user_id===u);c.user_id=Q>-1?u:null}((ie=(z=this.state)==null?void 0:z.selectedStaffMember)==null?void 0:ie.value)!==-1&&(c.user_id=(pt=(St=this.state)==null?void 0:St.selectedStaffMember)==null?void 0:pt.value),c.source="booking_widget";const o=this.newBaseUrl+"/appointment";if(this.state.calendar&&n.isNewCalendarWidgetEnabled){const u=document.getElementById("appointment-widgets-booking--revamp");u&&u.scrollIntoView({behavior:"smooth"})}let I=new FormData,C={};C.source="booking_widget";const V=Object.keys(c);for(const u of V)if(c[u]instanceof File)I.append(u,c[u]);else if((Ge=c[u])!=null&&Ge.files){const Q=Object.values(c[u].files);Q.length&&await Promise.all(Q.map(Ut=>{I.append(u,Ut)}))}else(c[u]||c[u]===0)&&(C[u]=c[u]);if(c!=null&&c.locationConfiguration&&(C.meetingLocationId=c.locationConfiguration),this.state.bookerMeetingLocation&&(C.bookerMeetingLocation=this.state.bookerMeetingLocation),this.state.showLoadingScreen=!0,f)try{C.source="booking_widget",C.channel="private_api";const u=await Pe.createRecurringEvents(bn(C));u.ids&&u.ids.length&&(await this.handleRecurringEventData(u),this.setCalendarBookingStateForConfirmationPage({appointment:{recurrenceId:u.recurrenceId},event_address:u.eventAddress,traceId:u.traceId}),this.state.appointmentIds=u.ids),this.state.stepInfo={...this.state.stepInfo,...Sn(u)},this.state.showLoadingScreen=!1}catch(u){this.state.showLoadingScreen=!1,console.error("error",u);let Q="";return((ve=u==null?void 0:u.response)==null?void 0:ve.status)===502?Q=((Ft=(ht=u==null?void 0:u.response)==null?void 0:ht.data)==null?void 0:Ft.msg)||"Something went wrong with your payment. Please try again.":Q=((x=(wt=u==null?void 0:u.response)==null?void 0:wt.data)==null?void 0:x.msg)||this.t("unable_to_schedule_appointment"),this.processFormError({error:Q}),{error:u}}else{this.state.isPaymentEnabled&&(C.paymentMeta={status:"pending"}),I.set("formData",JSON.stringify(C));try{const u=await $fetch(o,{method:"POST",body:I});this.setCalendarBookingStateForConfirmationPage(u),this.state.showLoadingScreen=!1,this.state.stepInfo={...this.state.stepInfo,...u},Ro({sessionId:(u==null?void 0:u.sessionId)||null,locationId:this.state.calendar.location_id});const Q=u==null?void 0:u.sessionFingerprint;return Q&&co(this.state.calendar.location_id,Q),u}catch(u){this.state.showLoadingScreen=!1,console.error("error",u);let Q="";return((yt=u==null?void 0:u.response)==null?void 0:yt.status)===502?Q=((Je=(Xt=u==null?void 0:u.response)==null?void 0:Xt._data)==null?void 0:Je.msg)||((It=(Nt=u==null?void 0:u.response)==null?void 0:Nt.data)==null?void 0:It.msg)||"Something went wrong with your payment. Please try again.":Q=((Ct=(he=u==null?void 0:u.response)==null?void 0:he._data)==null?void 0:Ct.msg)||((De=(ke=u==null?void 0:u.response)==null?void 0:ke.data)==null?void 0:De.msg)||this.t("unable_to_schedule_appointment"),this.processFormError({error:Q}),{error:u}}}}async handleRecurringEventData(n){let f=n.fingerprint;n.sessionFingerprint;let c={};try{const o="_ud";return c=await zo(n.contact,!0),this.state.calendar&&(c={...c,appointment:n.appointment}),zt(o,JSON.stringify(c)),zt(this.state.calendar.location_id,f),window.parent.postMessage(["set-sticky-contacts",o,JSON.stringify(c),this.state.calendar.location_id,f],"*"),c}catch(o){const I=window,C={formData:n,eventId:n.ids.join(","),error:o==null?void 0:o.stack,isUserSessionLoad:window.userSessionAttribution,logs:I.ConsoleSubscriber?I.ConsoleSubscriber.getErrors():[]};throw Pe.appointmentBookingLogs(this.state.traceId,C),o}}processFormError(n){n&&n.error&&(this.state.submissionError=n.error),this.state.isBackButtonDisabled=!1}async updateAppointment(){var o;const n=this.newBaseUrl+"/appointment",f={event_id:this.state.appointmentId,source:"booking_widget"};this.state.isPaymentEnabled&&(f.payment_meta={status:"completed"}),this.state.calendar&&(f.location_id=this.state.calendar.location_id,f.calendar_id=this.state.calendar.id,f.eventData=(o=this.state.contact)==null?void 0:o.formData);let c=new FormData;c.set("formData",JSON.stringify(f));try{const I=await $fetch(n,{method:"POST",body:c})}catch(I){console.log("error on payment update",I)}}async invalidateAppointment(){const{appointmentId:n,calendar:f,isRecurring:c,appointmentIds:o}=this.state;try{const I={event_id:n,calendar_id:f==null?void 0:f.id,location_id:f==null?void 0:f.location_id,appointment_status:"invalid",to_notify:!1};let C;return c?C=await Promise.all(o.map(V=>(I.event_id=V,$fetch(this.newBaseUrl+"/appointment",{method:"POST",body:I})))):C=await $fetch(this.newBaseUrl+"/appointment",{method:"POST",body:I}),C}catch(I){console.error("Error on invalidate appointment :",I)}}async updatePaymentDetailInEvent(){var n,f,c,o,I,C,V;if(Pe.appointmentBookingLogs(this.state.traceId,{eventId:this.state.appointmentId,message:"payment_update_started"}),!!this.state.isPaymentEnabled){try{const N={eventId:this.state.appointmentId,source:"booking_widget"};if(this.state.isPaymentEnabled&&(N.paymentMeta={status:"completed"}),this.state.calendar){N.locationId=this.state.calendar.location_id,N.calendarId=this.state.calendar.id,N.eventData=(f=(n=this.state.formSubmissionData)==null?void 0:n.formData)==null?void 0:f.eventData,N.meetingLocationId=this.state.meetingLocationId,N.bookerMeetingLocation=this.state.bookerMeetingLocation,N.transactionId=(c=this.state.paymentRes)==null?void 0:c.transactionId,N.chargeId=(o=this.state.paymentRes)==null?void 0:o.chargeId,N.formId=this.state.calendar.form_id,N.formSubmissionId=(I=this.state.formSubmissionData)==null?void 0:I.submissionId;const Ce=Nr(this.state.calendar.location_id),pe=uo(this.state.calendar.location_id);N.sessionFingerprint=pe,N.sessionId=Ce,((C=this.state.contact)!=null&&C.isNew||this.state.isSameContact)&&(N.isNewContact=!0)}let ae;if(this.state.isRecurring){const Ce=((V=this.state.formSubmissionData)==null?void 0:V.ids)||[];ae=(await Pe.updatePaymentDetailForRecurringAppointments(this.state.recurrenceId,N))[0]}else ae=await Pe.updatePaymentDetail(this.state.appointmentId,N);this.setStepInfo(ae);const Ie=ae==null?void 0:ae.sessionFingerprint;Ie&&co(this.state.calendar.location_id,Ie)}catch(N){console.error("error on payment update",N),Pe.appointmentBookingLogs(this.state.traceId,{eventId:this.state.appointmentId,message:"payment_update_failed",error:N})}Fn(this.state.calendar.id)}}async verifyRedirectPayment(n){Rr();const f=n.payment_intent,c=n.transactionId,o=n.setup_intent,I=n.redirect_status;if(f){this.state.showLoadingScreen=!0;const C=await this.verifyRedirectedPayment(f,c);if(this.state.showLoadingScreen=!1,C)return"success"}else if(o&&I==="succeeded")return"success";return this.state.paymentProcessingError="An error occurred while trying to process your payment. Please try again.","failed"}async verifyRedirectedPayment(n,f){var c;try{const o=(c=this.state.calendar)==null?void 0:c.location_id;let I;if(f){const C={altId:o,altType:"location",transactionId:f};I=await mo.verifyGenernalPayment(C)}if(I.success)return I;throw new Error(I.message)}catch{return this.state.paymentProcessingError="An error occurred while trying to process your payment. Please try again.",this.state.isBackButtonDisabled=!1,!1}}}const An=(s,n,f)=>{switch(s){case"isEqualTo":return n==f;case"isNotEqualTo":return n!=f;case"contains":return n==null?void 0:n.includes(f);case"startsWith":return n==null?void 0:n.startsWith(f);case"endsWith":return n==null?void 0:n.endsWith(f);case"isEmpty":return!n;case"isFilled":return n;case"before":return new Date(n)<new Date(f);case"after":return new Date(n)>new Date(f);case"greaterThan":return parseFloat(n)>parseFloat(f);case"lessThan":return parseFloat(n)<parseFloat(f);default:return console.warn(`Unknown selected operation: ${s}`),!1}},Ri=async(s,n,f,c,o,I,C,V,N,ae,Ie,Ce)=>{var pe,Ue,S,je;try{let Z=localStorage.getItem("_ud");Z&&(Z=JSON.parse(Z));const gt=Ne("am_id").value,ut=Ne("am_fingerprint").value,Ke=C.funnelName||"funnel",{funnelPageId:$,funnelId:bt,stepId:ct}=C;n||(n=window.location.hostname,f=window.location.pathname);const mt={altId:c,altType:"location",contactId:s,source:{type:sn.FORM,id:o,name:I,meta:{funnelId:bt,funnelName:Ke,stepId:ct,pageId:$,domain:n,pageUrl:f,affiliateManager:{id:gt,fingerprint:ut}}},products:V.map(z=>({id:z.id,qty:z.qty})),fingerprint:N,couponSessionId:Ie,couponCode:Ce,trackingId:ln(),traceId:Z==null?void 0:Z.traceId};ae&&(mt.captchaToken=ae);const ft=await mo.createOrder(mt);if(!((pe=ft.order)==null?void 0:pe._id))throw new Error("Something went wrong while creating order. Please try again later.");return ft}catch(Z){return console.error(Z),{error:!0,message:(S=(Ue=Z==null?void 0:Z.response)==null?void 0:Ue._data)==null?void 0:S.message,status:(je=Z==null?void 0:Z.response)==null?void 0:je.status}}},zi=async(s,n,f,c)=>{try{const o={altId:s,altType:"location",source:{type:"form",id:n},products:f.map(C=>({id:C.id,qty:C.qty})),couponCode:c};return await mo.getAmountSummary(o)}catch{throw new Error("Something went wrong while creating order. Please try again later.")}},Ni=s=>{let n=s.price*s.qty;return s.trialPeriod&&(n=0),n+(s.setupFee??0)};var He=(s=>(s.PRODUCT="product",s.DONATION="donation",s))(He||{});const Ln=M(()=>q(()=>import("./HLImage.7b173f62.js"),[],import.meta.url).then(s=>s.default||s)),On=M(()=>q(()=>import("./PhoneElement.90d99b00.js"),["./TextElement.0b941f97.css"],import.meta.url).then(s=>s.default||s)),Rn=M(()=>q(()=>import("./NumberElement.3e651725.js"),["./TextBoxListElement.b602ad61.css"],import.meta.url).then(s=>s.default||s)),zn=M(()=>q(()=>import("./EmailElement.10e11fcf.js"),["./EmailElement.029bb7ff.css"],import.meta.url).then(s=>s.default||s)),Nn=M(()=>q(()=>import("./HeadingElement.4a648cb9.js"),[],import.meta.url).then(s=>s.default||s)),Un=M(()=>q(()=>import("./MutlipleMeetingPicker.76f8b615.js"),["./MutlipleMeetingPicker.ead56035.css"],import.meta.url).then(s=>s.default||s)),xn=M(()=>q(()=>import("./ImageElement.6db60a13.js"),[],import.meta.url).then(s=>s.default||s)),Bn=M(()=>q(()=>import("./CaptchaElement.d85d736e.js"),["./CaptchaElement.dd481a17.css"],import.meta.url).then(s=>s.default||s)),Mn=M(()=>q(()=>import("./MonetaryElement.94b87fd3.js"),["./TextBoxListElement.b602ad61.css"],import.meta.url).then(s=>s.default||s)),qn=M(()=>q(()=>import("./CheckBoxElement.c5f3c7d1.js"),["./CheckBoxElement.cbef37c2.css"],import.meta.url).then(s=>s.default||s)),$n=M(()=>q(()=>import("./TermsAndConditionsElement.312e362d.js"),["./TermsAndConditionsElement.f4c1fd12.css"],import.meta.url).then(s=>s.default||s)),Wn=M(()=>q(()=>import("./RadioOptionElement.1fdff989.js"),["./RadioOptionElement.801ff641.css"],import.meta.url).then(s=>s.default||s)),Hn=M(()=>q(()=>import("./RadioImageOptionElement.73717212.js"),["./TextBoxListElement.b602ad61.css"],import.meta.url).then(s=>s.default||s)),jn=M(()=>q(()=>import("./CountryOptionElement.d4aee56c.js"),["./vue-multiselect.eb3eab67.css"],import.meta.url).then(s=>s.default||s)),Gn=M(()=>q(()=>import("./DateElement.63247eff.js"),["./DatePick.6beced99.css","./DateElement.e9cd5c5f.css"],import.meta.url).then(s=>s.default||s)),Jn=M(()=>q(()=>import("./StripePaymentElement.141c5856.js"),[],import.meta.url).then(s=>s.default||s)),Kn=M(()=>q(()=>import("./AuthorizeNetPaymentElement.2109a0e9.js"),["./AuthorizeNetPaymentElement.5c161814.css"],import.meta.url).then(s=>s.default||s)),Yn=M(()=>q(()=>import("./FormSurveyPayment.32048906.js"),["./ghl-payment-element.045b884e.css","./TextElement.0b941f97.css","./TextBoxListElement.b602ad61.css","./TextAreaElement.0c70ddc9.css","./OptionElement.05aaf420.css","./authorizeNet.328fe155.css","./FormSurveyPayment.bc5bf5fd.css","./vue-multiselect.eb3eab67.css","./app.5efdd9e1.css"],import.meta.url).then(s=>s.default||s)),Qn=M(()=>q(()=>import("./FileUploadElement.108d1355.js"),["./FileUploadElement.923d31a8.css"],import.meta.url).then(s=>s.default||s)),Zn=M(()=>q(()=>import("./SignatureElement.d88eed8a.js"),["./SignatureElement.99ad4b71.css"],import.meta.url).then(s=>s.default||s)),Xn=M(()=>q(()=>import("./FormSurveyAddressElement.c3cc81c6.js"),["./TextElement.0b941f97.css","./FormSurveyAddressElement.865d50fc.css"],import.meta.url).then(s=>s.default||s)),ei=M(()=>q(()=>import("./AddGuest.d09a695b.js"),["./AddGuest.79393527.css"],import.meta.url).then(s=>s.default||s)),ti=M(()=>q(()=>import("./AddGuestOld.7f62c69f.js"),["./AddGuestOld.b3decca9.css"],import.meta.url).then(s=>s.default||s)),oi=M(()=>q(()=>import("./Branding.b81c4699.js"),[],import.meta.url).then(s=>s.default||s)),ri=M(()=>q(()=>import("./OrderConfirmation.c7453d47.js"),["./TextElement.0b941f97.css","./TextBoxListElement.b602ad61.css","./TextAreaElement.0c70ddc9.css","./OptionElement.05aaf420.css","./authorizeNet.328fe155.css","./OrderConfirmation.e98c5326.css","./vue-multiselect.eb3eab67.css","./app.5efdd9e1.css"],import.meta.url).then(s=>s.default||s)),ai=M(()=>q(()=>import("./ThanksMessage.fcd6c2a8.js"),["./ThanksMessage.37e050aa.css"],import.meta.url).then(s=>s.default||s)),ni=M(()=>q(()=>import("./CalendarPaymentPage.c2162823.js").then(s=>s.a),["./ghl-payment-element.045b884e.css","./CalendarPaymentPage.d0445c33.css"],import.meta.url).then(s=>s.default||s)),ii={ref:"hl-app",class:"hl-app"},si={key:0},li=["id"],di={key:0,class:"col-sm-12 col-12"},ui={class:"loader-container"},Ui=za({__name:"FormComponent",props:{formId:{type:String,default:void 0},formData:{type:Object||Array,required:!0},calendar:{type:Object,default:void 0},selectedSlot:{type:Object,default:void 0},timezone:{type:String,default:void 0},event:{type:Object,default:void 0},error:{type:String,default:void 0},redirect:{type:Boolean,default:!0},funnelPreview:{type:Boolean,default:!1},formElementClass:{type:String,required:!1},calendarEventId:{type:String,required:!1},forCalendarV3:{type:Boolean,default:!1},pageUrl:{type:String,default:void 0},baseReferrrer:{type:String,default:void 0},urlParams:{type:Object,default:void 0},stickyContactData:{type:Object,default:void 0},stickyContactFingerprint:{type:String,default:void 0},iFrameId:{type:String,default:void 0},guests:{type:Array,default:[]},guestCountDetail:{type:Object,default:{}},seatsPerSlotData:{type:Object,default:{availableSeats:0,enableGuestSeating:!1}},calendarConfirmationButtonText:{type:String,default:void 0},isNewCalendarWidgetEnabled:{type:Boolean,default:!1},formSubmissionInstruction:{type:Object,default:{onlySubmitForm:!1,isRecurring:!1,shouldPayUsingPaymentElement:!1,totalRecurringBookings:1}},meetingLocationId:{type:String,default:void 0},bookerMeetingLocation:{type:String,default:void 0},calendarServiceHelper:{type:Object,default:{}},locale:{type:String,default:"en"}},emits:["step","processError","disableBackOnSubmit","onSubmit","onFormSubmitCallback","onProcessCalendarPayment"],async setup(s,{emit:n}){var fr;let f,c;const o=s;fe.extend(xr),fe.extend(Br),fe.extend(Ur);const{t:I}=Or(),C=zr();Yt(()=>o.formData,()=>{var a,i,l,b,g,p;const t=(l=(i=(a=o.formData)==null?void 0:a.form)==null?void 0:i.fields)==null?void 0:l.some(L=>L.tag==="group_address");o.formData.form.fields=(p=(g=(b=o.formData)==null?void 0:b.form)==null?void 0:g.fields)==null?void 0:p.filter(L=>!(t&&["address","city","country","state","postal_code"].includes(L.tag)))},{immediate:!0});const V=Rr();let N={},ae={},Ie={},Ce=y(!0),pe={},Ue=y(!1),S=y([]),je={},Z={},gt={},ut=y(""),Ke=y(!1),$=y(!0),bt={},ct=y(!1),mt={},ft={},ye=y(!1),z=y(""),ie=y(!1),St=y("US"),pt=y(),Ge=y("");y("");let yt=y(""),Xt=y([]),Je=y(!1);const Nt=y("");let It=y(),he=y({}),Ct=y(!0),ke=y(""),De=y(),ve=y(),ht=y(),Ft=y(),wt=y(),x=y(),u=y(),Q=y(),Ut={},fo=y(),U=y([]),po=y(!1),Et=y(""),Pt=y("");const No=y(!1),yo=y(""),xt=y(),e=Oo({phoneCountryIncluded:N,phoneCountryCode:Ie,formattedPhone:ae,form:pe,formStyle:je,buttonStyle:Z,company:bt,formFieldsValue:mt,validationError:ft,fieldStyle:gt,errors:Ut}),ho=y(),vo=y(),_o=y(),eo=y(),go=y({}),Uo=y(),kt=y(),Bt=y(),bo=y(),Mt=y(),qt=y(),_e=y({paymentType:He.DONATION,orderId:void 0}),$t=y(!1),Ye=y([]),Dt=y({}),xo=y(),Wt=y(!!(V.query.payment_intent||V.query.setup_intent)),to=y(),{getFormStyle:Mr,setFormStyle:qr,getFormWidth:So}=en(),{authorizeNetDispatchData:$r,setAuthorizeNetErrorResponse:Io,authorizeNetErrorResponse:Wr,authorizeNetCardNumberError:Bo,authorizeNetCardExpiryError:Mo,authorizeNetCardCVCError:qo,setAuthorizeNetCardNumberError:$o,setAuthorizeNetExpiryError:Wo,setAuthorizeNetCVCError:Ho,clearAuthorizeNetNewCardFormErrors:Hr}=Za(),jo=y(0),Co=y(null),Go=(t,a=!1)=>a&&t==="submit"?!1:Ao.indexOf(t)>=0,jr={bgColor:"E9ECEFFF",labelColor:((fr=e==null?void 0:e.fieldStyle)==null?void 0:fr.labelColor)||"",placeholderColor:"",border:"",width:"",padding:{top:15,bottom:15,left:20,right:20},shadow:""},Gr=t=>{var a,i;Mt.value=t,e.formFieldsValue.payment=((i=(a=e.form)==null?void 0:a.payment)==null?void 0:i.currency.symbol)+t},Jr=t=>{_e.value.orderId=t._id,_e.value.paymentType=He.PRODUCT,_e.value.amount=t.amount,_e.value.currency=t.currency},Kr=t=>{e.formFieldsValue.emailVerified=t},Jo=t=>{e.formFieldsValue.phoneVerified=t},Yr=()=>{if(o.calendar&&e.form.fullScreenMode)return{padding:"20px !important"};if(e.form.fullScreenMode)return{padding:"0px !important"}},Qr=(t,a)=>e.form.layout===_t.ONE_COLUMN?"col-12":(e.form.layout===_t.TWO_COLUMN||e.form.layout===!0)&&!Go(t.type)&&ro(a)?"menu-field-wrap col-sm-6 col-6":e.form.layout===_t.SINGLE_LINE?"menu-field-wrap col-12":"col-12",Zr=(t,a)=>{let i="";return(!Go(t.type,!1)||e.form.layout===_t.SINGLE_LINE&&t.type=="submit")&&(i=`
    @media screen and (min-width: 1025px) {
        #el_${o.formId}_${t.tag+"_"+a} {
        max-width: ${t.fullwidth?"100":t.fieldWidthPercentage}%;
        width: ${t.fullwidth?"100":t.fieldWidthPercentage}% !important;
        flex: 0 0 ${t.fullwidth?"100":t.fieldWidthPercentage}% !important;
      }
    `),i},Xr=t=>({marginBottom:ea(t)}),ea=t=>{var a,i;return t.hidden?0:(i=(a=e.form)==null?void 0:a.style)!=null&&i.hasOwnProperty("fieldSpacing")?e.form.style.fieldSpacing+"px":"16px"},ta=()=>{if(e.form.layout===_t.ONE_COLUMN){const t=["left","right"].includes(e.form.fieldStyle.labelAlignment);if(t)return`
      @media screen and (min-width: 600px) {
        .form-builder--item .label-alignment {
          width: ${t?e.form.fieldStyle.labelWidth+"px":""};
          display: ${t?"inline-block":"block"};
          float: ${t?"left":""};
          text-align: ${t?e.form.fieldStyle.labelAlignment:""};
          padding: ${t?"0 10px 0 0":""}
        }
      }`}return""},Ko=y(""),Fo=t=>{U.value.push(t)},oa=t=>t?"@import url('https://fonts.bunny.net/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i');":"@import url('https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i');",ra=async()=>{var p,L,B,h,O,m,T,W,se,oe,ne,le,ge,j,K,de,X,ee,F,E,Y,G,re,te,Be,ue,Me,Te,qe,vt,Qe,Ze,d,P,Xe,et,tt,ot,rt,at,v,D,k,R,ce,be,Ve,Ae,Le,Se,Oe,Re,me,$e,nt,it,st,lt,Fe,_,we,ze,no,pr,yr,hr,vr,_r,gr,br,Sr,Ir,Cr;const{locationId:t,form:a,country:i,companyId:l}=o.formData;if(!t||!a)return;e.form=Lr(a),yt.value=(p=e.form)==null?void 0:p.fbPixelId,z.value=t,St.value=i,Je.value="stickyContact"in e.form?(L=e.form)==null?void 0:L.stickyContact:!1,xo.value=oa(e.form.isGDPRCompliant);const b=o.formElementClass?`.${o.formElementClass}${kr}`:kr;if("layout"in e.form&&(Ke.value=[!0,_t.TWO_COLUMN,_t.SINGLE_LINE].includes((B=e.form)==null?void 0:B.layout)),(O=(h=e.form)==null?void 0:h.fieldStyle)!=null&&O.labelAlignment&&(Ko.value=ta()),"fields"in e.form&&(S.value=[...(m=e.form)==null?void 0:m.fields]),"style"in e.form){qr((T=e==null?void 0:e.form)==null?void 0:T.style,(W=e==null?void 0:e.form)==null?void 0:W.width),xt.value=(oe=(se=o==null?void 0:o.formData)==null?void 0:se.form)==null?void 0:oe.fieldCSS,xt.value&&!ko()&&o.formElementClass&&(xt.value=xt.value.replace(/#_builder-form/g,`.${o.formElementClass} #_builder-form`)),ct.value=((le=(ne=e.form)==null?void 0:ne.style)==null?void 0:le.ac_branding)??((j=(ge=e.form)==null?void 0:ge.style)==null?void 0:j.acBranding);const dt=(de=(K=e.form)==null?void 0:K.style)==null?void 0:de.bgImage;dt&&(Nt.value=`${o.funnelPreview?`.${o.formElementClass} #form-builder`:"body"} {background-image: url('${dt}');
        background-size: cover;
        background-repeat: no-repeat;
        background-attachment: fixed;
        background-position: top center}`)}((F=(ee=(X=e.form.formAction)==null?void 0:X.headerImageSrc)==null?void 0:ee.trim())==null?void 0:F.length)>0&&(yo.value=e.form.formAction.headerImageSrc),"button"in e.form&&(e.buttonStyle={bgColor:(Y=(E=e.form)==null?void 0:E.button)==null?void 0:Y.background,color:(re=(G=e.form)==null?void 0:G.button)==null?void 0:re.color,border:((ue=(Be=(te=e.form)==null?void 0:te.button)==null?void 0:Be.border)==null?void 0:ue.border)||0,borderColor:((qe=(Te=(Me=e.form)==null?void 0:Me.button)==null?void 0:Te.border)==null?void 0:qe.color)||hn,radius:(Ze=(Qe=(vt=e.form)==null?void 0:vt.button)==null?void 0:Qe.border)==null?void 0:Ze.radius,padding:(Xe=(P=(d=e.form)==null?void 0:d.button)==null?void 0:P.border)==null?void 0:Xe.padding}),(tt=(et=e.form)==null?void 0:et.style)!=null&&tt.color&&(It.value=`${b}label{ color:#${(rt=(ot=e.form)==null?void 0:ot.style)==null?void 0:rt.color} }`),(v=(at=e.form)==null?void 0:at.fieldStyle)!=null&&v.labelColor&&(It.value=`${b}label{ color:#${e.form.fieldStyle.labelColor} }`),"fieldStyle"in e.form?e.fieldStyle={bgColor:(k=(D=e==null?void 0:e.form)==null?void 0:D.fieldStyle)==null?void 0:k.bgColor,labelColor:(ce=(R=e==null?void 0:e.form)==null?void 0:R.fieldStyle)==null?void 0:ce.labelColor,labelFontFamily:(Ve=(be=e==null?void 0:e.form)==null?void 0:be.fieldStyle)==null?void 0:Ve.labelFontFamily,placeholderColor:(Le=(Ae=e==null?void 0:e.form)==null?void 0:Ae.fieldStyle)==null?void 0:Le.placeholderColor,border:(Oe=(Se=e==null?void 0:e.form)==null?void 0:Se.fieldStyle)==null?void 0:Oe.border,width:(me=(Re=e==null?void 0:e.form)==null?void 0:Re.fieldStyle)==null?void 0:me.width,padding:(nt=($e=e==null?void 0:e.form)==null?void 0:$e.fieldStyle)==null?void 0:nt.padding,shadow:(st=(it=e==null?void 0:e.form)==null?void 0:it.fieldStyle)==null?void 0:st.shadow}:e.fieldStyle=jr,"customStyle"in e.form&&((Fe=(lt=e.form)==null?void 0:lt.customStyle)==null?void 0:Fe.length)>0&&(ut.value=e.form.customStyle.replace(".form-element","")),"company"in e.form&&(e.company=(_=e.form)==null?void 0:_.company),"formLabelVisible"in e.form&&($.value=(we=e.form)==null?void 0:we.formLabelVisible);let g=o.calendar||(ze=e.form)==null?void 0:ze.payment;if(!g&&(no=o.calendar)!=null&&no.stripe&&(((yr=(pr=o.calendar)==null?void 0:pr.stripe)==null?void 0:yr.amount)==0||(vr=(hr=o.calendar)==null?void 0:hr.stripe)!=null&&vr.currency)){const dt={...o.calendar.stripe},At=o.formSubmissionInstruction;dt.amount=Ar(At==null?void 0:At.isRecurring,At==null?void 0:At.totalRecurringBookings,dt),delete dt.deposit,delete dt.depositType,g=dt}g&&(De.value={default_payment_provider:g.paymentProvider,publishable_key:g.publishable_key,account_id:g.account_id,amount:(parseFloat(g.amount)*100).toFixed(2),name:g.amount?"Pay to processed":"Verify your card",description:g.charge_description,currency:g.currency}),(_r=e.form)!=null&&_r.address&&(ve.value=(gr=e.form)==null?void 0:gr.address),Ce.value=!1,((Sr=(br=e.form)==null?void 0:br.payment)==null?void 0:Sr.paymentType)==="product"&&((Cr=(Ir=e.form)==null?void 0:Ir.payment)==null?void 0:Cr.products.length)>0&&await aa()},Ht=dn(),{$bus:Tt}=Ha(),xe=y([]),jt=y([]),Yo=y(!1),aa=async()=>{const t=e.form.payment.products.map(i=>i.productId),a=await mo.getPublicProducts({locationId:o.formData.locationId,productIds:t,includeNonStoreProducts:!0});Yo.value=!0,jt.value=e.form.payment.products.map(i=>{let l={};return a.products.forEach(b=>{i.productId===b._id&&(l=b)}),l={...l,...i,quantity:1},l}).filter(i=>i._id!==void 0)};[f,c]=Na(()=>ra()),await f,c();const na=Ee(()=>{var a;const t=(a=o.calendarServiceHelper)==null?void 0:a.state;return!(t!=null&&t.isFormFirst)&&!(t!=null&&t.isCustomPaymentProvider)&&(t==null?void 0:t.isPaymentEnabled)&&((t==null?void 0:t.isRecurring)&&(t==null?void 0:t.isRecurringSlotLoaded)||!(t!=null&&t.isRecurring))}),Qo=Ee(()=>S.value.find(t=>t.type==="submit")),Zo=Ee(()=>o.calendar&&o.calendar.enable_guests),Xo=Ee(()=>o.calendar&&o.calendar.enable_guests&&o.calendar.guest_type==="count_only"),er=Ee(()=>{var t;return((t=De.value)==null?void 0:t.default_payment_provider)==="stripe"}),tr=Ee(()=>{var t;return((t=De.value)==null?void 0:t.default_payment_provider)==="authorize-net"}),ia=Ee(()=>vn.find(t=>t.code===St.value)),or=Ee(()=>pt.value||St.value),rr=Ee(()=>Object.values(Vo)),Gt=Ee(()=>{var t,a,i,l,b,g,p;return(((t=o==null?void 0:o.calendar)==null?void 0:t.calendar_type)==="round_robin"||((a=o==null?void 0:o.calendar)==null?void 0:a.calendar_type)==="service_booking"||((i=o==null?void 0:o.calendar)==null?void 0:i.calendar_type)==="personal")&&((b=(l=o==null?void 0:o.calendar)==null?void 0:l.team_members)==null?void 0:b.length)===1?o==null?void 0:o.calendar.team_members[0].location_configurations:((g=o==null?void 0:o.calendar)==null?void 0:g.calendar_type)==="event"?(p=o==null?void 0:o.calendar)==null?void 0:p.location_configurations:null}),sa=(t,a)=>{Et.value=t,a&&(Pt.value=a)};Ee(()=>e.formStyle.border==="0"?"form-top-padding":"");const la=(t,a)=>{var i;$t.value=t.length>0,Ye.value=t,Dt.value=a,e.formFieldsValue.payment=(Dn((i=Ye.value[0])==null?void 0:i.currency)||"$")+a.summary.total},da=t=>{to.value=t},ua=Ee(()=>{var t,a,i,l,b,g,p,L,B,h,O;return(a=(t=S.value.filter(m=>m.hiddenFieldQueryKey==="payment"))==null?void 0:t[0])!=null&&a.hidden?!1:((l=(i=e.form)==null?void 0:i.payment)==null?void 0:l.paymentType)===He.PRODUCT?((g=(b=e.form)==null?void 0:b.payment)==null?void 0:g.required)&&((B=(L=(p=e.form)==null?void 0:p.payment)==null?void 0:L.products)==null?void 0:B.length)||$t.value:((O=(h=e.form)==null?void 0:h.payment)==null?void 0:O.required)||Mt.value});Ua({__dangerouslyDisableSanitizers:["style"],style:[{children:Nt.value,type:"text/css"},{children:xt.value,type:"text/css"},{children:It.value,type:"text/css"},{children:ut.value,type:"text/css"},{children:xo.value,type:"text/css"}],meta:[{name:"apple-mobile-web-app-capable",content:"yes"},{name:"viewport",content:"minimum-scale=1.0, width=device-width, maximum-scale=1, user-scalable=no"}]});let ar=!1;setTimeout(()=>{Zt(o.urlParams,V,e.phoneCountryIncluded,x.value,e.formFieldsValue,S.value,ve.value).then(t=>{e.phoneCountryIncluded=t.phoneCountryIncluded,e.formFieldsValue=t.formFieldsValue,x.value=t.formattedCountry,S.value=t.formFields})},ko()?1e3:100);const nr=y("");S.value.forEach((t,a)=>{if(t.type==="textbox_list"){const i={};t.picklistOptions.forEach(l=>{i[l.id]=l.prefillValue}),e.formFieldsValue[t.tag]=i}else t.type==="source"?e.formFieldsValue[t.tag]=t.value:t.type==="checkbox"&&!(e.formFieldsValue[t.tag]instanceof Array)?e.formFieldsValue[t.tag]=[]:t.type==="submit"&&(ar=!0,o.calendar&&(t.label&&t.label.toLowerCase()==="button"||t.label.trim().length<=0)&&(t.label=o.calendarConfirmationButtonText?o.calendarConfirmationButtonText:I(o.forCalendarV3?"schedule_meeting":"book_appointment")));nr.value+=Zr(t,a)}),ar||S.value.push({label:o.calendarConfirmationButtonText?o.calendarConfirmationButtonText:o.calendar?I(o.forCalendarV3?"schedule_meeting":"book_appointment"):I("submit"),tag:"button",palceholder:"button",type:"submit"}),S.value.length>0&&S.value.forEach((t,a)=>{if(t.type==="html"&&t&&"html"in t){const i=t.html.replace(/[‘’]/g,"'").replace(/[“”]/g,'"');Xt.value.push({scriptString:i,index:a})}}),ke.value=Math.random().toString(36).slice(2),o.urlParams&&Zt(o.urlParams,V,e.phoneCountryIncluded,x.value,e.formFieldsValue,S.value,ve.value).then(t=>{e.phoneCountryIncluded=t.phoneCountryIncluded,e.formFieldsValue=t.formFieldsValue,x.value=t.formattedCountry,S.value=t.formFields,setTimeout(()=>wo(),1e3)}),xa(async()=>{var b,g,p,L,B;!o.funnelPreview&&yt.value!==void 0&&yt.value!==""&&io(()=>{gn(yt.value,e.form.pageViewEvent)}),Va();const t=V.query.payment_intent,a=V.query.transactionId;t&&!((b=o.calendar)!=null&&b.id)&&(Wt.value=!0,await Fr(t,o.formId||"",a)?await mr():(sessionStorage.removeItem(`submissionResponse-${o.formId}`),sessionStorage.removeItem(`formOrderResponse-${o.formId}`)),Wt.value=!1);const i=V.query.setup_intent;if(i&&!((g=o.calendar)!=null&&g.id)&&(Wt.value=!0,await Fr(t,o.formId||"",a,i)?await mr():(sessionStorage.removeItem(`submissionResponse-${o.formId}`),sessionStorage.removeItem(`formOrderResponse-${o.formId}`)),Wt.value=!1),Je.value&&(xe.value=S.value.map(h=>h.tag),Po(void 0,z.value,xe.value,e.formFieldsValue,e.phoneCountryIncluded,x.value,ve.value).then(h=>{h?(e.formFieldsValue=h.formFieldsValue,e.phoneCountryIncluded=h.phoneCountryIncluded,x.value=h.formattedCountry):console.warn("Data not found! skippping stickycontact fill")}).catch(h=>{console.error("Failed at fillDataFromCookie",h)})),V.query.hasOwnProperty("sticky_contact_help")&&V.query.sticky_contact_help==="true"&&(console.log("%c Sticky Contact data","color: black; font-weight: bold; background-color: white"),console.log("%c ===================","color: black; font-weight: bold; background-color: white"),console.log(JSON.parse(Do("_ud"))),console.log("%c ===================","color: black; font-weight: bold; background-color: white")),io(()=>{Ue.value=!0}),o.calendar){if(o.locale!=="en"&&o.locale!=="en_US"){window.dayjs=fe;const h=Vr(o.locale);await un(`unpkg.com/dayjs@1.8.21/locale/${h}.js`,()=>{fe.locale(h)})}Tt.$on("submitCalendarForm",Jt)}if(o.calendar&&o.meetingLocationId&&(Et.value=o.meetingLocationId,o.bookerMeetingLocation&&(Pt.value=o.bookerMeetingLocation)),o.stickyContactData&&Je.value&&(xe.value||(xe.value=S.value.map(h=>h.tag)),Po(o.stickyContactData,z.value,xe.value,e.formFieldsValue,e.phoneCountryIncluded,x.value,ve.value).then(h=>{e.formFieldsValue=h.formFieldsValue,e.phoneCountryIncluded=h.phoneCountryIncluded,x.value=h.formattedCountry}).catch(h=>{console.error("Failed at fillDataFromCookie at sticky contact",h)})),po.value=!0,jo.value=new Date().getTime(),!V.query.notrack){let h=uo((p=o==null?void 0:o.formData)==null?void 0:p.locationId);const O=await wr({fingerprint:h,eventType:"form-view",mediumId:o.formId,medium:"form",locationId:o.formData.locationId,name:o.formData.name}),m=Yt(O,T=>{h!==T.fingerprint&&(h=T.fingerprint),m()})}setTimeout(()=>{wo(),ur(e.formFieldsValue),No.value=!0},100);const l=JSON.parse(localStorage.getItem("_ud")||"{}");if(Ht.value.formAction==="thankYouPage"&&e.form.formAction.actionType==="2"){ye.value=!0;const h=e.form.formAction.thankyouText?To(e.form.formAction.thankyouText,l):"Thanks for submiting details, Will get back to you soon!";he.value={action:"submit-form",message:h,style:e.form.submitMessageStyle,isFormPosted:ye.value,height:(B=(L=o.formData)==null?void 0:L.form)==null?void 0:B.height}}if(Ht.value.formAction==="orderConfirmationPage"&&e.form.formAction.actionType==="3"){const h=JSON.parse(sessionStorage.getItem(`formData-${o.formId}`)||"null");h&&(_e.value=h.productPurchased,Ye.value=h.productPurchasedList,Dt.value=h.productSummary,to.value=h.couponCode,_e.value&&Ye.value.length&&(ye.value=!0,he.value={action:"order",style:{width:e.form.width,style:e.form.style,fieldStyle:e.form.fieldStyle},productPurchased:Ye.value.map(O=>(jt.value.forEach(m=>{m._id===O.productId&&(O.showImage=m.showImage,O.showDescription=m.showDescription)}),O)),orderId:_e.value.orderId,productSummary:Dt.value,couponCode:to.value,contact:l}))}}),Ba(()=>{U.value=[]}),Yt(()=>o.urlParams,(t,a)=>{o.urlParams&&Zt(o.urlParams,V,e.phoneCountryIncluded,x.value,e.formFieldsValue,S.value,ve.value).then(i=>{e.phoneCountryIncluded=i.phoneCountryIncluded,e.formFieldsValue=i.formFieldsValue,x.value=i.formattedCountry,S.value=i.formFields})}),Yt(()=>o.stickyContactData,(t,a)=>{o.stickyContactData&&Je.value&&(xe.value||(xe.value=S.value.map(i=>i.tag)),Po(o.stickyContactData,z.value,xe.value,e.formFieldsValue,e.phoneCountryIncluded,x.value,ve.value).then(i=>{e.formFieldsValue=i.formFieldsValue,e.phoneCountryIncluded=i.phoneCountryIncluded,x.value=i.formattedCountry}).catch(i=>{console.error("Failed at fillDataFromCookie at sticky contact",i)}))}),Yt(()=>e.formFieldsValue,()=>{ao(e.formFieldsValue,!0),ur(e.formFieldsValue)},{deep:!0});const ir=t=>{pt.value=t},ca=t=>{e.validationError=t},ma=t=>{ht.value=t},fa=t=>{Ft.value=t},pa=(t,a,i)=>{ho.value=t&&t.length?t.replace(/\s/g,""):null,a&&a.length&&a.includes("/")&&(a=a.split("/"),vo.value=a[0],_o.value=a[1]),eo.value=i},ya=t=>{u.value=t},Vt=t=>{const{tag:a,value:i}=t;e.formFieldsValue[a]=i},sr=t=>{x.value=t,ao({...e.formFieldsValue,country:t},!0)},ha=t=>{Q.value=t},J=t=>{const{tag:a,error:i}=t;e.errors[a]=i,va(t),lr()},va=t=>{const{tag:a,error:i}=t;if(a=="email"&&o.guests.length>=1){const l=[e.formFieldsValue[a]];o.guests.forEach(b=>{l.includes(b.email)?(b.emailError="Email IDs must be unique for guests.",b.invalidEmail=!0):(b.emailError="",b.invalidEmail=!1),l.push(b.email)})}},_a=t=>{fo.value=t},ga=t=>{const{date:a,item:i}=t;e.formFieldsValue[i.tag]=a},oo=t=>{const a=e.phoneCountryIncluded[t.tag],i=e.phoneCountryCode[t.tag];e.formFieldsValue[t.tag]=a,t.tag==="phone"&&(Ge.value=e.formFieldsValue[t.tag]);try{const l=window.libphonenumber.parsePhoneNumberFromString(a,i);t.tag==="phone"&&(Ge.value=l.isValid()?l.number:a),e.phoneCountryIncluded[t.tag]=l.isValid()?l.number:a,e.phoneCountryCode[t.tag]=l.country?l.country:i,e.formattedPhone[t.tag]=l.isValid()?l.formatNational():a}catch{e.phoneCountryIncluded[t.tag]=a,e.formattedPhone[t.tag]=a}},ba=()=>{let t=!1,a=0;return S.value.map(i=>{i.type==="cascade_dropdown"&&i.required&&e.formFieldsValue[i.tag]===void 0?(Ct.value=!1,t=!0):e.formFieldsValue[i.tag]!==void 0&&i.type==="cascade_dropdown"&&(e.formFieldsValue[i.tag].forEach(function(b){for(const g in b)b[g]===""&&a++}),a>0?(Ct.value=!1,t=!0):Ct.value=!0)}),t},Sa=async t=>{const a=U.value.map(l=>{if(l!=null&&l.validate)return l.validate(t)});return await Promise.all(a),await lr()},Ia=async()=>{let t=!1;const a=U.value.map(i=>{var l;((l=i==null?void 0:i.item)==null?void 0:l.type)==="captcha"&&(t=!0)});return await Promise.all(a),t},lr=async()=>{const t=Object.values(e.errors);let a=!1;return await Promise.all(t.map(i=>{i&&(a=!0)})),a},ro=t=>{var i;return t===S.value.length-1||Ao.indexOf((i=S.value[t+1])==null?void 0:i.type)>=0?dr(t):!0},dr=t=>Ca(t)%2===0,Ca=t=>{let a=0;for(let i=t;i>=0;i--)if(Ao.indexOf(S.value[i].type)===-1)a+=1;else return a;return a},Fa=t=>{e.formFieldsValue[t.tag]=""},wa=t=>{const{item:a,event:i}=t;e.formFieldsValue[a.tag]=i.target.value},Ea=t=>{for(const a of S.value)if(a.hiddenFieldQueryKey===t&&(a.Id||a.id))return a.Id||a.id;return null},ao=(t,a=!1)=>{var p,L,B,h,O,m,T,W,se,oe,ne,le,ge,j,K,de,X,ee;const i={...t};if(x.value&&a&&(i.country=x.value),i!=null&&i.phone&&a){const F=(L=(p=window.libphonenumber)==null?void 0:p.parsePhoneNumberFromString(t.phone,e.phoneCountryCode.phone))==null?void 0:L.number;F&&(i.phone=F)}if(!((B=e.form)!=null&&B.conditionalLogic)||!((h=e.form.conditionalLogic)!=null&&h.length))return;const l=new Set,b=new Set,g=(m=(O=e.form)==null?void 0:O.conditionalLogic)==null?void 0:m.filter(F=>{var E,Y;return a?((E=F==null?void 0:F.outcome)==null?void 0:E.type)==="showHideFields":F.conditions!==null&&((Y=F==null?void 0:F.outcome)==null?void 0:Y.type)!=="showHideFields"});for(let F=0;F<g.length;F++){const E=g[F];let Y=E.conditionalOperation==="and";const G={...i};for(let re=0;re<E.conditions.length;re++){let{selectedField:te,selectedOperation:Be,inputValue:ue}=E.conditions[re];te==="country"&&!a&&Vo[G[te]]&&(G[te]=Vo[G[te]]);const Me=Ea(te);Me!==null&&(te=Me);const Te=G[te],qe=An(Be,typeof Te=="string"?Te.toLowerCase():Te,typeof ue=="string"?ue.toLowerCase():ue);if(E.conditionalOperation==="and"&&!qe){Y=!1;break}if((E.conditionalOperation==="or"||E.conditionalOperation==="then")&&qe){Y=!0;break}}if(((T=E.outcome)==null?void 0:T.type)==="showHideFields"&&a&&Y){const{hideType:re,value:te}=E.outcome;(Array.isArray(te)?te:[te]).forEach(ue=>{re.includes("Show")?l.add(ue):re.includes("Hide")&&b.add(ue)})}if(Y){if(((W=E.outcome)==null?void 0:W.type)==="displayCustomMessage"||((se=E.outcome)==null?void 0:se.type)==="disqualifyLead"&&((oe=E.outcome)==null?void 0:oe.disqualifyAction)==="showCustomMessage"?(e.form.formAction.actionType="2",e.form.formAction.thankyouText=E.outcome.value):(((ne=E.outcome)==null?void 0:ne.type)==="redirectToUrl"||((le=E.outcome)==null?void 0:le.type)==="disqualifyLead"&&((ge=E.outcome)==null?void 0:ge.disqualifyAction)==="openUrl")&&(e.form.formAction.actionType="1",e.form.formAction.redirectUrl=E.outcome.value,e.form.formAction.redirect_url=E.outcome.value),((j=E.outcome)==null?void 0:j.type)==="disqualifyLead"&&(e.form.disqualified=!0),!a)break}else((de=(K=e.form)==null?void 0:K.payment)!=null&&de.required||Mt.value||$t.value)&&!((ee=(X=S.value)==null?void 0:X.find(re=>re.hiddenFieldQueryKey==="payment"))!=null&&ee.hidden)&&(e.form.formAction.actionType=o.formData.form.formAction.actionType,e.form.formAction.thankyouText=o.formData.form.formAction.thankyouText,e.form.formAction.redirectUrl=o.formData.form.formAction.redirectUrl,e.form.disqualified=void 0)}l.forEach(F=>b.delete(F)),Co.value&&(S.value=Co.value),S.value=S.value.map(F=>{if(l.has(F.hiddenFieldQueryKey)){const E=o.formData.form.fields.find(Y=>Y.hiddenFieldQueryKey===F.hiddenFieldQueryKey);return{...F,hidden:!1,hiddenFieldValue:(E==null?void 0:E.hiddenFieldValue)||"",required:(E==null?void 0:E.required)||!1}}else if(b.has(F.hiddenFieldQueryKey))return{...F,hidden:!0,required:!1};return F}),Zt(o.urlParams,V,e.phoneCountryIncluded,x.value,e.formFieldsValue,S.value,ve.value,!0).then(F=>{e.phoneCountryIncluded=F.phoneCountryIncluded,e.formFieldsValue=F.formFieldsValue,x.value=F.formattedCountry,S.value=F.formFields})},ur=t=>{tn(e.form,S.value,t).forEach(({hiddenFieldQueryKey:i,result:l})=>{e.formFieldsValue[i]=l})},wo=()=>{var l,b;setTimeout(()=>ao(e.formFieldsValue,!0),0);const t=(b=(l=e.form)==null?void 0:l.conditionalLogic)==null?void 0:b.filter(g=>{var p;return((p=g==null?void 0:g.outcome)==null?void 0:p.type)==="showHideFields"});let a=[],i=[];t&&(t.forEach(g=>{if(g.outcome.type==="showHideFields"){const{hideType:p,value:L}=g.outcome,B=Array.isArray(L)?L:[L];p.includes("Show")?(a=[...new Set([...a,...B])],i=i.filter(h=>!B.includes(h))):p.includes("Hide")&&(i=[...new Set([...i,...B])],a=a.filter(h=>!B.includes(h)))}}),S.value.forEach(g=>{a.includes(g.hiddenFieldQueryKey)?(g.hidden=!0,g.required=!1,g.hiddenFieldValue=""):i.includes(g.hiddenFieldQueryKey)&&(g.hidden=!1,g.hiddenFieldValue="")}),Co.value=Lr(S.value))},Pa=async()=>(await rn(e.formFieldsValue,x.value),(await an(V,S.value,e.formFieldsValue)).formFieldsValue),Jt=async(t,a)=>{var L,B,h,O,m,T,W,se,oe,ne,le,ge;let i=o.formSubmissionInstruction;if(i.isRecurring=(i==null?void 0:i.isRecurring)??((L=o.calendar)==null?void 0:L.enable_recurring),u.value)return;for(let j in e.phoneCountryIncluded)e.phoneCountryIncluded[j]&&oo({tag:j});if(await on(e.formFieldsValue)>cn){alert("The total size of the attached files cannot be more that 50MB");return}if(e.validationError={},await Sa(a)||ba())return;if(await Ia()&&(Q.value===void 0||Q.value==="0")){e.validationError.captcha="Invalid Captcha";return}let p;if(n("disableBackOnSubmit",{disable:!0}),ie.value=!0,u.value="",!((h=(B=o.calendarServiceHelper)==null?void 0:B.state)!=null&&h.isFormFirst)&&!((m=(O=o.calendarServiceHelper)==null?void 0:O.state)!=null&&m.isCustomPaymentProvider)&&((W=(T=o.calendarServiceHelper)==null?void 0:T.state)!=null&&W.isPaymentEnabled)&&!await((se=o.calendarServiceHelper)==null?void 0:se.newCardPaymentElementRef.value.validatePayment()))return n("disableBackOnSubmit",{disable:!1}),ie.value=!1,!1;if(!(i!=null&&i.onlySubmitForm)&&!(i!=null&&i.shouldPayUsingPaymentElement)){if(er.value&&De.value&&!wt.value){p={};try{const j=i.isRecurring,K=i.totalRecurringBookings,{client_secret:de}=await $fetch(C.public.serverBaseUrl+"/appointment/setup-intent",{method:"POST",body:{locationId:o.formData.locationId,calendarId:o.calendar.id}});if(!de)throw u.value="Something went wrong while processing your payment, please try again.",new Error("clientSecret missing");let X,ee;if(e.formFieldsValue.first_name&&(ee=e.formFieldsValue.first_name.trim()),e.formFieldsValue.full_name&&(ee=e.formFieldsValue.full_name.trim()),X=await ht.value.confirmCardSetup(de,{payment_method:{card:Ft.value,billing_details:ee?{name:ee}:{}}},{handleActions:!1}),X.error)throw u.value=X.error.message,X.error;{const F={...e.formFieldsValue};if(Je.value){let G;if(typeof Storage<"u")try{G=Do(z.value)}catch{console.error("Failed to fetch contact from local storage")}G||(G=Ne(z.value).value||Ne("msgsndr_id").value),G&&(F.contact_id=G)}Ge.value&&(F.phone=Ge.value);const E={location_id:z.value,calendar_id:o.calendar.id,payment_method_id:X.setupIntent.payment_method,setup_intent_status:X.setupIntent.status,customer_data:F,...j?{totalRecurringBookings:K}:{}},Y=await $fetch(C.public.serverBaseUrl+"/appointment/setup-stripe-customer-and-payment-intent",{method:"POST",body:E});if(Y.status==="requires_action"){const G=await ht.value.handleCardAction(Y.client_secret);if(G.error)throw u.value=G.error.message,G.error;p.payment_intent_id=G.paymentIntent.id}else p.payment_intent_id=Y.id;p.stripe_customer_id=Y.stripe_customer_id}}catch(j){return console.error(j),u.value||(u.value="Something went wrong while processing your payment, please try again."),n("disableBackOnSubmit",{disable:!1}),ie.value=!1,!1}}else if(tr.value&&De.value){p={};let j=!1;if(ho.value||($o(!0),j=!0),(!vo.value||!_o.value)&&(Wo(!0),j=!0),eo.value||(Ho(!0),j=!0),j||Bo.value||Mo.value||qo.value)return;Io(""),Hr();try{const{publishable_key:K,account_id:de}=De.value,X={authData:{clientKey:K,apiLoginID:de},cardData:{cardNumber:ho.value,month:vo.value,year:_o.value,cardCode:eo.value}},ee=await $r(X);p={opaqueData:ee==null?void 0:ee.opaqueData,cardCode:eo.value}}catch(K){if(K.type==="authorizeNetServerError"){Io((ge=(le=(ne=(oe=K==null?void 0:K.response)==null?void 0:oe.messages)==null?void 0:ne.message)==null?void 0:le[0])==null?void 0:ge.text);return}Io((K==null?void 0:K.message)||"Something went wrong!")}}}e.formFieldsValue=await Pa(),await Da(p,i,t,a),n("disableBackOnSubmit",{disable:!0})},ka=t=>{const a={};for(const i in t)t.hasOwnProperty(i)&&(a[i.replace(/(\_\w)/g,function(l){return l[1].toUpperCase()})]=t[i]);return a},Da=async(t,a,i,l)=>{var ne,le,ge,j,K,de,X,ee,F,E,Y,G,re,te,Be,ue,Me,Te,qe,vt,Qe,Ze,d,P,Xe,et,tt,ot,rt,at;const b=Ne("msgsndr_id").value;if(o.formId&&(e.formFieldsValue.formId=o.formId),e.formFieldsValue.location_id=z.value,Ge.value&&(e.formFieldsValue.phone=Ge.value),Je.value){let v;if(o.stickyContactFingerprint&&(v=o.stickyContactFingerprint),!v&&typeof Storage<"u")try{v=Do("location_"+z.value)}catch{console.error("Failed to get contact from local storage")}v||(v=Ne(z.value).value||b),v&&(e.formFieldsValue.contact_id=v)}const g=V.query.contact_id||((ne=o.urlParams)==null?void 0:ne.contact_id);g&&(e.formFieldsValue.query_contact_id=g);const p=e.formFieldsValue;Bt.value=null,(le=o.calendar)!=null&&le.form_submit_type?o.calendar.form_submit_type==="RedirectURL"&&(Bt.value=o.calendar.form_submit_redirect_url||o.calendar.thank_you_url):((K=(j=(ge=o.calendar)==null?void 0:ge.thank_you_url)==null?void 0:j.trim())==null?void 0:K.length)>0&&(Bt.value=(de=o.calendar)==null?void 0:de.thank_you_url),o.event?p.event_id=V.query.event_id:o.calendarEventId&&(p.event_id=o.calendarEventId),o.guests.length?p.guests=o.guests.map(({name:v,email:D})=>({name:v,email:D})):o.guestCountDetail.count&&(p.guestCount=o.guestCountDetail.count),o.calendar&&(p.calendar_id=o.calendar.id,a!=null&&a.onlySubmitForm||(p.selected_slot=(X=o.selectedSlot)==null?void 0:X.format(),p.selected_timezone=o.timezone,Et.value&&(p.meeting_location_id=Et.value),Pt.value&&(p.booker_meeting_location=Pt.value))),a!=null&&a.onlySubmitForm||(wt.value?p.stripeToken=wt.value:t&&(p.stripePaymentResult=t));const L=Nr(p.locationId);L&&(p.sessionId=L),o.calendar&&wn(o.calendar.id,p),kt.value=mn(),p.eventData={...fn(o.pageUrl,o.baseReferrrer),fbEventId:kt.value};let B=uo(p.locationId);if(B&&(p.sessionFingerprint=B),o.funnelPreview){let{domain:v,page_url:D}=V.query;v||(v=window.location.hostname,D=window.location.pathname),p.funneEventData={event_type:"optin",domain_name:v,page_url:D,funnel_id:Ht.value.funnelId,page_id:Ht.value.funnelPageId,funnel_step_id:Ht.value.stepId}}fo.value&&(p.captchaToken=fo.value);let h=C.public.REST_API_URLS+"/forms/submit";if(o.calendar){if(o.isNewCalendarWidgetEnabled){const v=o.formElementClass?"booking-"+o.formElementClass:"calendar-"+((ee=o.calendar)==null?void 0:ee.id),D=document.querySelector(`.${v}`);D&&D.scrollIntoView({behavior:"smooth"})}a.onlySubmitForm||(h=C.public.newBaseURL+"/appointment"),La(p)}let O=new FormData,m={};Object.keys(p).forEach(async v=>{var D;if(p[v]instanceof File)O.append(v,p[v]);else if((D=p[v])!=null&&D.files){const k=Object.values(p[v].files);k.length&&await Promise.all(k.map(R=>{O.append(v,R)}))}else(p[v]||p[v]===0)&&(m[v]=p[v])}),V.query.user_id&&(m.user_id=V.query.user_id);const W=Ne("am_id").value,se=Ne("sam_id").value,oe=Ne("am_fingerprint").value;if(W&&(m.amId=W),oe&&(m.amFingerprint=oe),se&&(m.samId=se),o.calendar){if(m.eventData.medium=Er.Calendar,m.eventData.mediumId=m==null?void 0:m.calendar_id,o.formId){let v=S.value.filter(D=>D.type==="date");m.dateFieldDetails=v}}else m.eventData.medium=Er.Form,m.eventData.mediumId=m==null?void 0:m.formId;if(e.form.isLeadGenVideo&&(m.internalSource={type:"hosted_video"}),e.form.enableTimezone!==!1&&(m.Timezone=`${pn()} ${yn()}`),qt.value&&(m.submissionId=qt.value),go.value&&(m.paymentContactId=go.value),(Mt.value||$t.value)&&(m.paymentStatus="Pending"),a!=null&&a.shouldPayUsingPaymentElement&&(m.payment_meta={status:"pending"}),(E=(F=S.value)==null?void 0:F.find(v=>v.hiddenFieldQueryKey==="payment"))!=null&&E.hidden&&(delete m.payment,delete m.paymentStatus,delete m.paymentContactId),a.onlySubmitForm&&(m.internalSource={type:"calendar",id:(Y=o.calendar)==null?void 0:Y.id},m.source=((G=o.calendar)==null?void 0:G.name)||((re=o.calendar)==null?void 0:re.id),m.calendar_name=(te=o.calendar)==null?void 0:te.name,(Be=o.calendar)!=null&&Be.stripe&&(((Me=(ue=o.calendar)==null?void 0:ue.stripe)==null?void 0:Me.amount)==0||(qe=(Te=o.calendar)==null?void 0:Te.stripe)!=null&&qe.currency))){const v={...o.calendar.stripe};m.payment=Ar(a==null?void 0:a.isRecurring,a==null?void 0:a.totalRecurringBookings,v)}if(n("onFormSubmitCallback",{meetingLocationId:Et.value,bookerMeetingLocaion:Pt.value}),a.onlySubmitForm||!(a!=null&&a.isRecurring)){o.calendar||ao(m),m.disqualified=e.form.disqualified,O.set("formData",JSON.stringify(m));const v={},D=(Qe=(vt=Intl==null?void 0:Intl.DateTimeFormat())==null?void 0:vt.resolvedOptions())==null?void 0:Qe.timeZone;D&&(v.timezone=D),$fetch(h,{method:"POST",body:O,headers:v}).then(async k=>{var ce;let R=uo((ce=o==null?void 0:o.formData)==null?void 0:ce.locationId);V.query.notrack||wr({fingerprint:R,eventType:"form-submitted",mediumId:o.formId,medium:"form",locationId:o.formData.locationId,name:o.formData.name,timeSpent:(new Date().getTime()-jo.value)/1e3}),bo.value=k,go.value=k.contactId,qt.value=k.submissionId,sessionStorage.setItem(`submissionResponse-${o.formId}`,JSON.stringify(bo.value)),sessionStorage.setItem(`formData-${o.formId}`,JSON.stringify({phoneCountryIncluded:e.phoneCountryIncluded,formattedCountry:x.value,formFieldsValue:e.formFieldsValue,formFields:S.value,productPurchased:_e.value,productPurchasedList:Ye.value,productSummary:Dt.value,submissionId:qt.value})),!o.calendar&&ua.value?await Uo.value.processPayment(k.contactId,k.fingerprint,k.contact,i,l):(await Eo(k),a.onlySubmitForm||(k.formData=m),n("onFormSubmitCallback",{formSubmissionData:k}))}).catch(k=>{var R,ce,be,Ve,Ae,Le,Se,Oe,Re;if(ie.value=!1,console.error("error",k),n("onFormSubmitCallback",{loadingScreen:{showLoadingScreen:!1}}),o.calendar){let me="";((R=k==null?void 0:k.response)==null?void 0:R.status)===502?me=((be=(ce=k==null?void 0:k.response)==null?void 0:ce._data)==null?void 0:be.msg)||((Ae=(Ve=k==null?void 0:k.response)==null?void 0:Ve.data)==null?void 0:Ae.msg)||"Something went wrong with your payment. Please try again.":(me=((Se=(Le=k==null?void 0:k.response)==null?void 0:Le._data)==null?void 0:Se.msg)||((Re=(Oe=k==null?void 0:k.response)==null?void 0:Oe.data)==null?void 0:Re.msg)||I("unable_to_schedule_appointment"),me=me||"unable_to_schedule_appointment"),n("processError",{error:me})}})}else try{m.source=(Ze=o.calendar)==null?void 0:Ze.name,m.channel="private_api",m.calendar_name=(d=o.calendar)==null?void 0:d.name,m.internalSource={type:"calendar",id:(P=o.calendar)==null?void 0:P.id},O.set("formData",JSON.stringify(m));const v={};$fetch(C.public.REST_API_URLS+"/forms/submit",{method:"POST",body:O,headers:v}).then(async D=>{var ce,be,Ve,Ae,Le,Se,Oe,Re,me,$e,nt,it,st;const k={...m,contact:{id:(ce=D.contact)==null?void 0:ce.id},source:"booking_widget",formSubmissionId:D==null?void 0:D.submissionId,isNewContact:D==null?void 0:D.isNew,skipFormSubmit:!0};(Ve=(be=o.calendarServiceHelper)==null?void 0:be.setCustomState)==null||Ve.call(be,{showLoadingScreen:!0});const R=await Pe.createRecurringEvents(ka(k));if(R.ids&&R.ids.length){let lt,Fe=R.fingerprint,_=R.sessionFingerprint,we={};try{o.calendar&&(lt=e.formFieldsValue,Fe=R.contactId);const ze="_ud";we=await zo(R.contact,!0),o.calendar&&(we={...we,appointment:R.appointment}),zt(ze,JSON.stringify(we)),zt("location_"+z.value,Fe),window.parent.postMessage(["set-sticky-contacts",ze,JSON.stringify(we),z.value,Fe],"*"),window.parent.postMessage(["set-sticky-contacts",`embedded_iframe_${o.iFrameId}`,o.iFrameId,z.value,Fe],"*"),o.event||(Ro({sessionId:R.sessionId||null,locationId:z.value}),_&&!((Le=(Ae=o.calendarServiceHelper)==null?void 0:Ae.state)!=null&&Le.isPaymentEnabled)&&co(z.value,_)),(Oe=(Se=o.calendarServiceHelper)==null?void 0:Se.setCustomState)==null||Oe.call(Se,{showLoadingScreen:!1}),n("onSubmit",{fingerprint:Fe}),R.formData=m,R.appointment={recurrenceId:R.recurrenceId},n("onFormSubmitCallback",{formSubmissionData:R})}catch(ze){const no={formData:lt||R,eventId:R.ids.join(","),error:ze.stack,isUserSessionLoad:window.userSessionAttribution,logs:window.ConsoleSubscriber?window.ConsoleSubscriber.getErrors():[]};Pe.appointmentBookingLogs((me=(Re=o.calendarServiceHelper)==null?void 0:Re.state)==null?void 0:me.traceId,no),(nt=($e=o.calendarServiceHelper)==null?void 0:$e.setCustomState)==null||nt.call($e,{showLoadingScreen:!1})}if(o.calendar||io(()=>{Dr("track",e.form.formSubmissionEvent,kt.value)}),o.calendar){const ze={contactId:R.contactId,calendarThankYouUrl:Bt.value,ids:R.ids,fingerprint:Fe,event_address:R.eventAddress||"",cookiePayload:we,fbEventId:kt.value};n("step",ze);return}if(o.redirect===!1)return;if("formAction"in e.form&&parseInt(e.form.formAction.actionType)===1)window.top.location.href=lo(e.form.formAction.redirect_url||e.form.formAction.redirectUrl,we);else if("redirect_url"in e.form&&e.form.redirect_url!==""||"redirectUrl"in e.form&&e.form.redirectUrl!=="")window.top.location.href=lo(e.form.redirect_url||e.form.redirectUrl,we);else{ye.value=!0;const ze=e.form.formAction.thankyouText?To(e.form.formAction.thankyouText,we):"Thanks for submiting details, Will get back to you soon!";k.value={action:"submit-form",message:ze,style:e.form.submitMessageStyle,isFormPosted:ye.value,height:(st=(it=o.formData)==null?void 0:it.form)==null?void 0:st.height},e.form.isLeadGenVideo&&Tt.$emit("video-lead-popup-submitted",e.form.videoId)}e.form.isLeadGenVideo&&Tt.$emit("video-lead-popup-submitted",e.form.videoId)}else throw I("unable_to_schedule_appointment")}).catch(D=>{console.error("error",D)})}catch(v){if(console.error("error",v),(Xe=o.calendarServiceHelper)==null||Xe.setCustomState({showLoadingScreen:!1}),o.calendar){let D="";((et=v==null?void 0:v.response)==null?void 0:et.status)===502?D=((ot=(tt=v==null?void 0:v.response)==null?void 0:tt.data)==null?void 0:ot.msg)||"Something went wrong with your payment. Please try again.":D=((at=(rt=v==null?void 0:v.response)==null?void 0:rt.data)==null?void 0:at.msg)||I("unable_to_schedule_appointment"),n("processError",{error:D})}}},Eo=async t=>{var i,l,b,g,p,L;const a=Ne("msgsndr_id").value;if(t.status||t.id){let B=t.formData,h=t.fingerprint,O=t.sessionFingerprint,m={};if(a!==h){const T=Ne("msgsndr_id",{path:"/",maxAge:31536e3});T.value=h}try{o.calendar&&(B=e.formFieldsValue,h=t.contactId);const T="_ud";if(m=await zo(t.contact,!0),o.calendar){const W=t==null?void 0:t.appointment,se=Vr(o.locale),oe=(ne,le)=>fe(ne).locale(se).format(le);if(W){const ne={...W,only_end_date:oe(W.only_end_date,"dddd, ll"),only_start_date:oe(W.only_start_date,"dddd, ll"),start_time:oe(W.start_time,"llll"),end_time:oe(W.end_time,"llll")};m={...m,appointment:ne}}}zt(T,JSON.stringify(m)),zt("location_"+z.value,h),window.parent.postMessage(["set-sticky-contacts",T,JSON.stringify(m),z.value,h],"*"),window.parent.postMessage(["set-sticky-contacts",`embedded_iframe_${o.iFrameId}`,o.iFrameId,z.value,h],"*"),o.event||(Ro({sessionId:t.sessionId||null,locationId:z.value}),O&&co(z.value,O)),n("onSubmit",{fingerprint:h})}catch(T){const W={formData:B||t,eventId:t.id,error:T.stack,isUserSessionLoad:window.userSessionAttribution,logs:window.ConsoleSubscriber?window.ConsoleSubscriber.getErrors():[]};Pe.appointmentBookingLogs((l=(i=o.calendarServiceHelper)==null?void 0:i.state)==null?void 0:l.traceId,W)}if(o.calendar||io(()=>{Dr("track",e.form.formSubmissionEvent,kt.value)}),o.calendar){const T={contactId:t.contactId,calendarThankYouUrl:Bt.value,id:t.id,fingerprint:h,event_address:t.event_address,cookiePayload:m,fbEventId:kt.value};n("step",T);return}if(o.redirect===!1)return;if("formAction"in e.form&&parseInt(e.form.formAction.actionType)===1&&!e.form.isLeadGenVideo){const T=lo(e.form.formAction.redirect_url||e.form.formAction.redirectUrl,m);Pr(T)}else if(("redirect_url"in e.form&&e.form.redirect_url!==""||"redirectUrl"in e.form&&e.form.redirectUrl!=="")&&!e.form.isLeadGenVideo){const T=lo(e.form.redirect_url||e.form.redirectUrl,m);Pr(T)}else if("formAction"in e.form&&parseInt((g=(b=e==null?void 0:e.form)==null?void 0:b.formAction)==null?void 0:g.actionType)==3&&_e.value.orderId)ye.value=!0,he.value={action:"order",style:{width:e.form.width,style:e.form.style,fieldStyle:e.form.fieldStyle},productPurchased:Ye.value.map(T=>(jt.value.forEach(W=>{W._id===T.productId&&(T.showImage=W.showImage,T.showDescription=W.showDescription)}),T)),orderId:_e.value.orderId,productSummary:Dt.value,couponCode:to.value,contact:t.contact};else{ye.value=!0;const T=e.form.formAction.thankyouText?To(e.form.formAction.thankyouText,m):"Thanks for submiting details, Will get back to you soon!";he.value={action:"submit-form",message:T,style:e.form.submitMessageStyle,isFormPosted:ye.value,height:(L=(p=o.formData)==null?void 0:p.form)==null?void 0:L.height},e.form.isLeadGenVideo&&Tt.$emit("video-lead-popup-submitted",e.form.videoId)}e.form.isLeadGenVideo&&Tt.$emit("video-lead-popup-submitted",e.form.videoId)}},Ta=async t=>{var a,i,l;if(t.type==="error")t.message&&(e.form.payment.required||Mt.value||$t.value)&&(ie.value=!1,J({tag:"payment",error:t.message}));else if(t.type==="pre_process")await Jt(t.data,t.provider);else if(t.type==="success"){sessionStorage.removeItem(`formOrderResponse-${o.formId}`);const b={submissionId:qt.value,orderId:_e.value.orderId,paymentType:((a=_e.value)==null?void 0:a.paymentType)===He.PRODUCT?He.PRODUCT:He.DONATION,locationId:z.value,formId:o.formId,transactionId:["authorize-net","nmi","square"].includes(t.provider)?(i=t.data)==null?void 0:i.transactionId:(l=t.data.data)==null?void 0:l.transactionId};await cr(b,bo.value)}},cr=async(t,a)=>{try{await _n.patchSubmission(t),Eo(a)}catch(i){console.error(i),Eo(a)}},mr=async()=>{var i;const t=sessionStorage.getItem(`formData-${o.formId}`);if(t){const l=JSON.parse(t);Zt(o.urlParams,V,l.phoneCountryIncluded,l.formattedCountry,l.formFieldsValue,l.formFields,ve.value).then(b=>{e.phoneCountryIncluded=b.phoneCountryIncluded,e.formFieldsValue=b.formFieldsValue,x.value=b.formattedCountry,S.value=b.formFields,setTimeout(()=>wo(),1e3)})}const a=sessionStorage.getItem(`submissionResponse-${o.formId}`);if(t&&a){const l=JSON.parse(t),b=JSON.parse(a),g={submissionId:l.submissionId,orderId:l.productPurchased.orderId,paymentType:((i=l.productPurchased)==null?void 0:i.paymentType)===He.PRODUCT?He.PRODUCT:He.DONATION,locationId:z.value,formId:o.formId,transactionId:V.query.transactionId||"51651414"};_e.value=l.productPurchased,Ye.value=l.productPurchasedList,Dt.value=l.productSummary,await cr(g,b)}},Va=()=>{o.calendar&&(xe.value=S.value.map(t=>t.tag),setTimeout(()=>{En(o.calendar.id,xe.value,e.formFieldsValue,e.phoneCountryIncluded,x.value).then(t=>{if(t){e.formFieldsValue=t.formFieldsValue,e.phoneCountryIncluded=t.phoneCountryIncluded,x.value=t.formattedCountry;for(let a in e.phoneCountryIncluded)e.phoneCountryIncluded[a]&&oo({tag:a})}else console.warn("session data not found! skipping contact fill")}).catch(t=>{console.error("Failed at loadDataFromSessionStorage",t)})},ko()?1005:100))},Aa=async t=>{var a,i;t.type==="error"&&(t!=null&&t.message)&&(n("disableBackOnSubmit",{disable:!1}),ie.value=!1),Pe.appointmentBookingLogs((i=(a=o.calendarServiceHelper)==null?void 0:a.state)==null?void 0:i.traceId,{message:"payment_callback",component:"FormComponent"}),n("onProcessCalendarPayment",t)},La=t=>{[...Vn,"payment_session_id","calendarElementClass"].forEach(i=>{var l;(l=t==null?void 0:t.eventData)==null||delete l.url_params[i]})};return Ma(()=>{Tt.$off("submitCalendarForm",Jt)}),(t,a)=>{var Qe,Ze;const i=ja,l=Ln,b=Ga,g=On,p=Rn,L=zn,B=Nn,h=Ja,O=Un,m=Ka,T=xn,W=Ya,se=Bn,oe=Mn,ne=qn,le=$n,ge=Wn,j=Hn,K=jn,de=Qa,X=Gn,ee=Jn,F=Kn,E=Yn,Y=Qn,G=Zn,re=Xa,te=Xn,Be=ei,ue=ti,Me=oi,Te=ri,qe=ai,vt=ni;return w(),Lt("div",ii,[so(i,{type:"text/css",children:r(Ko)},null,8,["children"]),so(i,{type:"text/css",children:r(nr)},null,8,["children"]),Ot("section",{id:"form-builder",class:Qt(["hl_form-builder--main",r(e).form.fullScreenMode?"hl_form-builder--main-full":""]),style:Rt(Yr())},[r(yo).trim().length>0?(w(),Lt("div",si,[Ot("div",{class:"max-w-full ghl-banner w-full",style:Rt({maxWidth:r(So)+"px"})},[so(l,{url:r(yo),width:r(So),alt:"banner"},null,8,["url","width"])],4)])):We("",!0),Ot("div",{style:Rt({maxWidth:r(So)+"px",marginBottom:r(e).form.fullScreenMode?"0 !important":""}),class:"ghl-form-wrap"},[r(ye)?We("",!0):(w(),Lt("div",{key:0,id:"_builder-form",style:Rt(r(Mr)()),name:"builder-form",class:Qt(["form-builder--wrap",r(e).form.fullScreenMode?"form-builder--wrap-full":""])},[Ot("div",{class:Qt([r(Ke)?"builder-inline":"flex-col",r($)?"":"extra-top-padding","fields-container row"])},[(w(!0),Lt(qa,null,$a(r(S),(d,P)=>{var Xe,et,tt,ot,rt,at,v,D,k,R,ce,be,Ve,Ae,Le,Se,Oe,Re,me,$e,nt,it,st,lt,Fe;return w(),Lt("div",{key:P,id:"el_"+o.formId+"_"+d.tag+"_"+P,style:Rt(Xr(d)),class:Qt([[Qr(d,P),r(Ke)?"menu-field-wrap":"",{calendar_notes:d.tag==="calendar_notes"},{location_picker:d.tag==="locationConfiguration"},{"payment-block":d.type==="payment"}],"form-field-wrapper"])},[Ot("div",{class:Qt([P%2==0?"f-even":"f-odd","form-field-container"])},[d.type==="text"?(w(),A(b,{key:0,kind:"form",item:r(H)(d),"form-label-visible":r($),"phone-country-included":r(e).phoneCountryIncluded,"phone-country-code":r(e).phoneCountryCode,"location-country":r(or),"form-fields-value":r(e).formFieldsValue,"formatted-phone":r(e).formattedPhone,"phone-country-derived":r(pt),errors:r(e).errors,"layout-type":r(e).form.layout,"check-full-width-position":ro(P),"font-size":(tt=(et=(Xe=r(e))==null?void 0:Xe.form)==null?void 0:et.fieldStyle)==null?void 0:tt.placeholderFontSize,locationId:(ot=o==null?void 0:o.formData)==null?void 0:ot.locationId,"medium-id":s.formId,onVerifyPhone:Jo,onUpdatePhoneCountryDerived:ir,onCustomFieldPhoneNumberUpdate:oo,onAddOrUpdateError:J,ref_for:!0,ref:_=>{r(U)[P]=_}},null,8,["item","form-label-visible","phone-country-included","phone-country-code","location-country","form-fields-value","formatted-phone","phone-country-derived","errors","layout-type","check-full-width-position","font-size","locationId","medium-id"])):d.type==="phone"?(w(),A(g,{key:1,kind:"form",item:r(H)(d),"form-label-visible":r($),"phone-country-included":r(e).phoneCountryIncluded,"phone-country-code":r(e).phoneCountryCode,"location-country":r(or),"form-fields-value":r(e).formFieldsValue,"phone-country-derived":r(pt),"formatted-phone":r(e).formattedPhone,errors:r(e).errors,"layout-type":r(e).form.layout,"check-full-width-position":ro(P),"font-size":(v=(at=(rt=r(e))==null?void 0:rt.form)==null?void 0:at.fieldStyle)==null?void 0:v.placeholderFontSize,locationId:(D=o==null?void 0:o.formData)==null?void 0:D.locationId,"medium-id":s.formId,onVerifyPhone:Jo,onAddOrUpdateError:J,onUpdatePhoneCountryDerived:ir,onCustomFieldPhoneNumberUpdate:oo,ref_for:!0,ref:_=>{r(U)[P]=_}},null,8,["item","form-label-visible","phone-country-included","phone-country-code","location-country","form-fields-value","phone-country-derived","formatted-phone","errors","layout-type","check-full-width-position","font-size","locationId","medium-id"])):d.type==="number"||d.type==="numerical"||d.dataType==="SCORE"?(w(),A(p,{key:2,kind:"form",item:r(H)(d),"form-label-visible":r($),"form-fields-value":r(e).formFieldsValue,errors:r(e).errors,onAddOrUpdateError:J,ref_for:!0,ref:_=>{r(U)[P]=_}},null,8,["item","form-label-visible","form-fields-value","errors"])):d.type==="email"?(w(),A(L,{key:3,kind:"form",item:r(H)(d),"form-label-visible":r($),"form-fields-value":r(e).formFieldsValue,errors:r(e).errors,"layout-type":r(e).form.layout,"check-full-width-position":ro(P),"font-size":(ce=(R=(k=r(e))==null?void 0:k.form)==null?void 0:R.fieldStyle)==null?void 0:ce.placeholderFontSize,onAddOrUpdateError:J,onVerifyEmail:Kr,locationId:(be=o==null?void 0:o.formData)==null?void 0:be.locationId,ref_for:!0,ref:_=>{r(U)[P]=_}},null,8,["item","form-label-visible","form-fields-value","errors","layout-type","check-full-width-position","font-size","locationId"])):We("",!0),d.type==="h1"?(w(),A(B,{key:4,item:r(H)(d)},null,8,["item"])):d.type==="textbox_list"?(w(),A(h,{key:5,kind:"form",item:r(H)(d),"form-label-visible":r($),"form-fields-value":r(e).formFieldsValue,"local-tag-id":r(ke),errors:r(e).errors,onAddOrUpdateError:J,ref_for:!0,ref:_=>{r(U)[P]=_}},null,8,["item","form-label-visible","form-fields-value","local-tag-id","errors"])):(d==null?void 0:d.type)==="location_picker"&&r(Gt)&&(((Ve=r(Gt))==null?void 0:Ve.length)>1||((Ae=r(Gt))==null?void 0:Ae.length)===1&&((Se=(Le=r(Gt))==null?void 0:Le[0])==null?void 0:Se.kind)==="booker")&&s.isNewCalendarWidgetEnabled?(w(),A(O,{key:6,ref_for:!0,ref:_=>{r(U)[P]=_},kind:"form",data:{locationConfiguration:r(Gt)},"form-fields-value":r(e).formFieldsValue,errors:r(e).errors,item:r(H)(d),onUpdateSelectedLocation:sa,onAddOrUpdateError:J,"default-value":r(Et),"default-booker-location":r(Pt)},null,8,["data","form-fields-value","errors","item","default-value","default-booker-location"])):d.type==="textarea"||d.type=="large_text"?(w(),A(m,{key:7,kind:"form",item:r(H)(d),"form-label-visible":r($),"form-fields-value":r(e).formFieldsValue,errors:r(e).errors,onAddOrUpdateError:J,ref_for:!0,ref:_=>{r(U)[P]=_}},null,8,["item","form-label-visible","form-fields-value","errors"])):d.type==="img"&&"url"in d?(w(),A(T,{key:8,kind:"form",item:r(H)(d),ref_for:!0,ref:_=>{r(U)[P]=_}},null,8,["item"])):d.type==="html"&&r(po)&&r(No)?(w(),A(W,{key:9,item:r(H)(d),localTagId:r(ke)+P,ref_for:!0,ref:_=>{r(U)[P]=_}},null,8,["item","localTagId"])):d.type==="captcha"?(w(),A(se,{key:10,kind:"form",item:r(H)(d),"form-label-visible":r($),"captcha-input-value":r(Q),"local-tag-id":r(ke),"validation-error":r(e).validationError,onUpdateValidationError:ca,onUpdateIsCaptchaVerified:ha,onUpdateCaptchaToken:_a,ref_for:!0,ref:_=>{r(U)[P]=_}},null,8,["item","form-label-visible","captcha-input-value","local-tag-id","validation-error"])):d.type==="monetory"?(w(),A(oe,{key:11,kind:"form",item:r(H)(d),"form-label-visible":r($),"form-fields-value":r(e).formFieldsValue,"locale-currency":r(ia),errors:r(e).errors,onAddOrUpdateError:J,onUpdateFormFieldsValue:Vt,ref_for:!0,ref:_=>{r(U)[P]=_}},null,8,["item","form-label-visible","form-fields-value","locale-currency","errors"])):d.type==="checkbox"?(w(),A(ne,{key:12,kind:"form",item:r(H)(d),"form-label-visible":r($),"form-fields-value":r(e).formFieldsValue,layout:r(e).form.layout,"local-tag-id":r(ke),errors:r(e).errors,onAddOrUpdateError:J,onUpdateFormFieldsValue:Vt,ref_for:!0,ref:_=>{r(U)[P]=_}},null,8,["item","form-label-visible","form-fields-value","layout","local-tag-id","errors"])):d.type==="terms_and_conditions"?(w(),A(le,{key:13,kind:"form",item:r(H)(d),"form-label-visible":r($),labelFontFamily:r(e).fieldStyle.labelFontFamily,"form-fields-value":r(e).formFieldsValue,"local-tag-id":r(ke),errors:r(e).errors,onAddOrUpdateError:J,onUpdateFormFieldsValue:Vt,ref_for:!0,ref:_=>{r(U)[P]=_}},null,8,["item","form-label-visible","labelFontFamily","form-fields-value","local-tag-id","errors"])):d.type==="radio"&&d.picklistOptions?(w(),A(ge,{key:14,kind:"form",item:r(H)(d),"form-label-visible":r($),"form-fields-value":r(e).formFieldsValue,"local-tag-id":r(ke),errors:r(e).errors,layout:r(e).form.layout,onAddOrUpdateError:J,onResetFieldsValue:Fa,onSetRadioValue:wa,ref_for:!0,ref:_=>{r(U)[P]=_}},null,8,["item","form-label-visible","form-fields-value","local-tag-id","errors","layout"])):d.type==="radio"&&d.picklistOptionsImage?(w(),A(j,{key:15,kind:"form",item:r(H)(d),"form-label-visible":r($),"form-fields-value":r(e).formFieldsValue,layout:r(e).form.layout,"local-tag-id":r(ke),errors:r(e).errors,onAddOrUpdateError:J,ref_for:!0,ref:_=>{r(U)[P]=_}},null,8,["item","form-label-visible","form-fields-value","layout","local-tag-id","errors"])):d.type==="select"&&d.tag=="country"?(w(),A(K,{key:16,kind:"form",item:r(H)(d),"form-label-visible":r($),"formatted-country":r(x),countries:r(rr),errors:r(e).errors,onUpdateFormattedCountry:sr,onAddOrUpdateError:J,ref_for:!0,ref:_=>{r(U)[P]=_}},null,8,["item","form-label-visible","formatted-country","countries","errors"])):d.type==="single_options"||d.type==="multiple_options"?(w(),A(de,{key:17,kind:"form",item:r(H)(d),"form-label-visible":r($),"form-fields-value":r(e).formFieldsValue,errors:r(e).errors,onAddOrUpdateError:J,ref_for:!0,ref:_=>{r(U)[P]=_}},null,8,["item","form-label-visible","form-fields-value","errors"])):d.type==="date"?(w(),A(X,{key:18,kind:"form",item:r(H)(d),"form-label-visible":r($),"form-fields-value":r(e).formFieldsValue,errors:r(e).errors,ref_for:!0,ref:_=>{r(U)[P]=_},onDateSelected:ga,onAddOrUpdateError:J},null,8,["item","form-label-visible","form-fields-value","errors"])):d.type==="payment"&&r(er)?(w(),A(ee,{key:19,calendar:s.calendar,payment:r(De),stripe:r(ht),card:r(Ft),"card-error-msg":r(u),onUpdateStripe:ma,onUpdateCard:fa,onUpdateCardErrorMsg:ya,ref_for:!0,ref:_=>{r(U)[P]=_}},null,8,["calendar","payment","stripe","card","card-error-msg"])):d.type==="payment"&&r(tr)&&r(po)?(w(),A(F,{key:20,kind:"form",calendar:s.calendar,payment:r(De),setAuthorizeNetNewCardDetails:pa,authorizeNetCardNumberError:r(Bo),authorizeNetCardExpiryError:r(Mo),authorizeNetCardCVCError:r(qo),setAuthorizeNetCardNumberError:r($o),setAuthorizeNetExpiryError:r(Wo),setAuthorizeNetCVCError:r(Ho),authorizeNetErrorResponse:r(Wr)},null,8,["calendar","payment","authorizeNetCardNumberError","authorizeNetCardExpiryError","authorizeNetCardCVCError","setAuthorizeNetCardNumberError","setAuthorizeNetExpiryError","setAuthorizeNetCVCError","authorizeNetErrorResponse"])):!s.calendar&&d.type==="payment"&&(((Re=(Oe=r(e).form)==null?void 0:Oe.payment)==null?void 0:Re.paymentType)==="product"&&r(Yo)&&r(jt).length>0||(($e=(me=r(e).form)==null?void 0:me.payment)==null?void 0:$e.paymentType)!=="product")?(w(),A(E,{key:21,kind:"form",item:r(H)(d),payment:r(e).form.payment,products:r(jt),style:Rt(r(e).form.fieldStyle),"form-label-visible":r($),locationId:r(z),"form-id":s.formId,isPaymentInProcessing:r(ie),"form-name":s.formData.name,errors:r(e).errors,formItems:r(e).form,formValues:r(e).formFieldsValue,onOnPaymentCallback:Ta,onAddOrUpdateError:J,onPaymentAmount:Gr,onProductOrder:Jr,onOnOrderApiFail:a[0]||(a[0]=()=>Wa(ie)?ie.value=!1:ie=!1),onProductSelected:la,onCouponCode:da,ref_for:!0,ref:_=>{r(U)[P]=_,Uo.value=_}},null,8,["item","payment","products","style","form-label-visible","locationId","form-id","isPaymentInProcessing","form-name","errors","formItems","formValues"])):d.type==="file_upload"?(w(),A(Y,{key:22,kind:"form",item:r(H)(d),"form-fields-value":r(e).formFieldsValue,"form-label-visible":r($),errors:r(e).errors,onUpdateFormFieldsValue:Vt,onAddOrUpdateError:J,ref_for:!0,ref:_=>{r(U)[P]=_}},null,8,["item","form-fields-value","form-label-visible","errors"])):d.type==="signature"?(w(),A(G,{key:23,kind:"form",item:r(H)(d),"form-fields-value":r(e).formFieldsValue,"form-label-visible":r($),ref_for:!0,ref:_=>{r(U)[P]=_},errors:r(e).errors,onUpdateFormFieldsValue:Vt,onAddOrUpdateError:J},null,8,["item","form-fields-value","form-label-visible","errors"])):d.type==="submit"&&!r(Zo)?(w(),A(re,{key:24,item:r(H)(d),layout:r(e).form.layout,"form-label-visible":r(e).form.formLabelVisible,"button-style":r(e).buttonStyle,calendar:s.calendar,"form-submit-disable":r(ie),onClick:Jt,ref_for:!0,ref:_=>{r(U)[P]=_},errors:r(e).errors},null,8,["item","layout","form-label-visible","button-style","calendar","form-submit-disable","errors"])):d.tag==="group_address"?(w(),A(te,{key:25,kind:"form",item:r(H)(d),"form-fields-value":r(e).formFieldsValue,"form-label-visible":r($),"formatted-country":r(x),countries:r(rr),ref_for:!0,ref:_=>{r(U)[P]=_},errors:r(e).errors,onUpdateFormFieldsValue:Vt,onUpdateFormattedCountry:sr,onAddOrUpdateError:J,addressData:r(ve),fieldSpacing:(st=(it=(nt=r(e))==null?void 0:nt.form)==null?void 0:it.style)==null?void 0:st.fieldSpacing,fieldStyle:r(e).fieldStyle,locationId:(lt=o==null?void 0:o.formData)==null?void 0:lt.locationId,companyId:(Fe=o==null?void 0:o.formData)==null?void 0:Fe.companyId,id:s.formId,source:"forms"},null,8,["item","form-fields-value","form-label-visible","formatted-country","countries","errors","addressData","fieldSpacing","fieldStyle","locationId","companyId","id"])):We("",!0)],2)],14,li)}),128)),r(Zo)?(w(),Lt("div",di,[s.isNewCalendarWidgetEnabled?(w(),A(Be,{key:0,guests:s.guests,"guest-count-detail":s.guestCountDetail,"collect-guest-count":r(Xo),"seats-per-slot-data":o.seatsPerSlotData,"form-fields-value":r(e).formFieldsValue,ref:d=>Fo(d),onAddOrUpdateError:J},null,8,["guests","guest-count-detail","collect-guest-count","seats-per-slot-data","form-fields-value"])):(w(),A(ue,{key:1,guests:s.guests,"guest-count-detail":s.guestCountDetail,"collect-guest-count":r(Xo),"seats-per-slot-data":o.seatsPerSlotData,"form-fields-value":r(e).formFieldsValue,ref:d=>Fo(d),onAddOrUpdateError:J},null,8,["guests","guest-count-detail","collect-guest-count","seats-per-slot-data","form-fields-value"])),r(Qo)?(w(),A(re,{key:2,item:r(Qo),"button-style":r(e).buttonStyle,calendar:s.calendar,"form-submit-disable":r(ie),onClick:Jt,ref:d=>Fo(d),errors:r(e).errors,class:"menu-field-wrap col-sm-12 col-12 calendar_notes mt-20"},null,8,["item","button-style","calendar","form-submit-disable","errors"])):We("",!0)])):We("",!0)],2),s.formData!=null&&r(ct)?(w(),A(Me,{key:0,company:r(e).company},null,8,["company"])):We("",!0)],6)),r(he)&&r(he).action==="order"?(w(),A(Te,{key:1,id:"order-confirmation",payload:r(he)},null,8,["payload"])):We("",!0),r(he)&&r(he).action==="submit-form"?(w(),A(qe,{key:2,id:"_builder-form",payload:r(he)},null,8,["payload"])):We("",!0),r(na)?(w(),A(vt,{key:3,ref:s.calendarServiceHelper.newCardPaymentElementRef,state:s.calendarServiceHelper.state,showSessionExpire:!1,onOnPaymentCallback:Aa},null,8,["state"])):We("",!0)],4)],6),Ot("div",ui,[so(Tn,{loading:r(Wt)&&!((Ze=(Qe=s.calendarServiceHelper)==null?void 0:Qe.state)!=null&&Ze.isPaymentEnabled),color:"#188bf6",size:"30px"},null,8,["loading"])])],512)}}});export{Oi as C,He as F,Ui as _,Ri as a,Ni as c,zi as g,Li as i,Vn as r};
